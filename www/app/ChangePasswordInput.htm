<html>
<head>
<title>Change Password</title>
<link rel='stylesheet' href='../style/MACRO1.css' type='text/css'>
<script language='javascript' src='../script/Dialog.js'></script>
<script language='javascript'>
function fnPageLoaded()
{
	var aQS=fnSplitQS(window.location.search);
	document.all['divName'].innerHTML='<b>User: '+aQS['name']+'</b>';
	var sLabel="";
	if ((aQS['exp']!=undefined)&&(aQS['exp']=='true'))
	{
		sLabel="<b>YOUR ACCOUNT PASSWORD HAS EXPIRED</b><br><br>"
	}
	sLabel+='Please update login password for user '+aQS['name'];
	document.all['divLabel'].innerHTML=sLabel;
	txtP1.focus();
}
function fnSubmit()
{
	var sOld = txtP1.value;
	var sNew = txtP2.value;
	var sConfirm = txtP3.value;
	
	if (sOld=="")
	{
		alert("you have not entered your existing password");
		txtP1.focus();
		return false;
	}
	if (sNew=="")
	{
		alert("you have not entered a new password");
		txtP2.focus();
		return false;
	}
	if (sNew!=sConfirm)
	{
		alert("password and confirmation do not match");
		txtP3.value="";
		txtP3.focus();
		return false;
	}
	if (!fnAlphaNumeric(txtP2.value))
	{
		alert("Password may only contain alphanumeric characters")
		return false;
	}
	fnReturn(sOld+"`"+sNew);
}
function fnAlphaNumeric(vValue)
{
	//allow alphanumeric or space
	var	sCheck = /[^a-zA-Z0-9 ]/;
	return (sCheck.exec(vValue)==null);
}
</script>
</head><body onload='fnPageLoaded();'><table align='center' width='95%' border='0'>
<tr height='10'><td></td></tr>
<tr height='15' class='clsLabelText'><td colspan='2'><div id='divName'></div></td><td><a style='cursor:hand;' onclick='javascript:fnReturn("");'><u>Cancel</u></a></td><td><a style='cursor:hand;' onclick='javascript:fnSubmit();'><u>OK</u></a></td></tr><tr height='15'><td></td></tr>
<tr height='5'><td></td></tr><tr height='30'><td colspan='4' class='clsLabelText'>
<div id='divLabel'></div></td></tr>
<tr height='5'><td></td></tr>
<tr><td width='150' class='clsLabelText'>Old Password</td>
<td><input style='width:180px;' class='clsTextbox' name='txtP1' type='password'></td>
</tr>
<tr><td class='clsLabelText'>New Password</td>
<td><input style='width:180px;' class='clsTextbox' name='txtP2' type='password'>
</td></tr>
<tr><td class='clsLabelText'>Confirm Password</td>
<td><input style='width:180px;' class='clsTextbox' name='txtP3' type='password'>
</td></tr>
</table>
</body></html>