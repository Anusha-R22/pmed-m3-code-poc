<head>
<title>New Discrepancy</title>
<link rel='stylesheet' href='../style/MACRO1.css' type='text/css'>
<script language="javascript">
var sDel1="`";
var undefined;
function fnPageLoaded()
{
	var aArgs=window.dialogArguments;
	fnSetCaption(aArgs[0]);
	fnSetLabel("Please enter Discrepancy text");
	fnSetValue(aArgs[1]);
	txtInput.focus();
}
function fnSetCaption(sCaption)
{
	document.all["divName"].innerHTML="<b>Question: "+sCaption+"</b>";
}
function fnSetLabel(sLabel)
{
	document.all["divLabel"].innerHTML=sLabel;
}
function fnSetValue(sValue)
{
	document.all["divValue"].innerHTML=(sValue!=undefined)? "<b>Value: "+sValue+"</b>":"<b>Value:</b>";
}
function fnSubmit()
{
	var aArgs=window.dialogArguments;
	var sRtn="";
	var sStr=txtInput.value;
	var sOC=txtOCID.value;
	var sPr=selPriority.value

	if ((!fnIllegalChars(sStr))&&(!fnIllegalChars(sOC)))
	{
		if ((fnLength(sStr,2000))&&(fnLength(sOC,30)))
		{
			sRtn="d|"+sStr+"|"+sOC+"|"+sPr;
		}
		else
		{
			alert("Discrepancy text cannot exceed 2000 characters in length")
			txtInput.select();
			return;
		}
	}
	else
	{
		alert("Discrepancies cannot contain the following characters: `|~\"");
		txtInput.select();
		return;
	}		
	fnReturn(sRtn);
}
function fnIllegalChars(sStr)
{
	var sPattern = /[`|~"]/;
	return sPattern.exec(sStr);
}	
function fnLength(sStr,nLength)
{
	if (sStr.length>nLength) return false;
	return true;
}
function fnReturn(sVal)
{
	this.returnValue=sVal;
	this.close();
}
</script>
</head>
<body onload='fnPageLoaded();'><table align='center' width='95%' border='0'>
<tr height='10'><td></td></tr>
<tr height='15' class='clsLabelText'><td colspan='2'>
<table width='100%' cellpadding='0' cellspacing='0' border='0'>
<tr class='clsLabelText'>
<td><div id='divName'>name</div></td>
<td><div id='divValue'>value</div></td>
</tr>
</table>
</td>
<td><a style='cursor:hand;' onclick='javascript:fnSubmit();'><u>OK</u></a></td>
<td><a style='cursor:hand;' onclick='javascript:fnReturn("");'><u>Cancel</u></a></td>
</tr>
<tr height='15'><td></td></tr>
<tr height='5'><td></td></tr>
<tr height='30'><td colspan='4' class='clsLabelText'>
<div id='divLabel'>label</div></td></tr>
<tr height='5'><td></td></tr>
<tr><td width='100' class='clsLabelText'></td>
<td><textarea class='clsTextbox' cols=50 rows=5 name="txtInput" maxlength="255" wrap="physical"></TEXTAREA></td>
</tr>
<tr><td colspan='2'>
<table border="0" class="clsLabelText" width="100%">
<tr>
<td width="25%" align="right">OC Discrepancy ID</td><td width="20%"><input name="txtOCID" type="text" size="5"></td>
<td width="10%" align="right">Priority</td>
<td width="10%"><select name="selPriority">
<option value="1">1</option>
<option value="2">2</option>
<option value="3">3</option>
<option value="4">4</option>
<option value="5" selected>5</option>
<option value="6">6</option>
<option value="7">7</option>
<option value="8">8</option>
<option value="9">9</option>
<option value="10">10</option>
</select></td></tr>
</table>
</td></tr></table>
</body></html>