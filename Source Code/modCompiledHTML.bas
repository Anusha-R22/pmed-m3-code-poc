Attribute VB_Name = "modCompiledHTML"
' Autogenerated code, Copyright InferMed 2002 (30/09/2003 16:34:55)

'-----------------------------------------------------------------------------
Public Function CompiledStyleSheetHTML() As String
'-----------------------------------------------------------------------------
Dim s As String
s = ""
s = s & "A:hover" & vbCrLf
s = s & "{" & vbCrLf
s = s & "    TEXT-DECORATION: none" & vbCrLf
s = s & "}" & vbCrLf
s = s & "A" & vbCrLf
s = s & "{" & vbCrLf
s = s & "    COLOR: blue" & vbCrLf
s = s & "}" & vbCrLf
s = s & "A:visited" & vbCrLf
s = s & "{" & vbCrLf
s = s & "    COLOR: blue" & vbCrLf
s = s & "}" & vbCrLf
s = s & "BODY" & vbCrLf
s = s & "{" & vbCrLf
s = s & "    SCROLLBAR-FACE-COLOR: #e0e0ff;" & vbCrLf
s = s & "    MARGIN: 0px;" & vbCrLf
s = s & "    SCROLLBAR-HIGHLIGHT-COLOR: #e0e0ff;" & vbCrLf
s = s & "    SCROLLBAR-SHADOW-COLOR: #e0e0ff;" & vbCrLf
s = s & "    SCROLLBAR-3DLIGHT-COLOR: gray;" & vbCrLf
s = s & "    SCROLLBAR-ARROW-COLOR: gray;" & vbCrLf
s = s & "    SCROLLBAR-DARKSHADOW-COLOR: gray;" & vbCrLf
s = s & "    SCROLLBAR-BASE-COLOR: gray;" & vbCrLf
s = s & "    margin-width: 0px;" & vbCrLf
s = s & "    margin-height: 0px;" & vbCrLf
s = s & "}" & vbCrLf
s = s & ".clsMacroText" & vbCrLf
s = s & "{" & vbCrLf
s = s & "    FONT-WEIGHT: normal;" & vbCrLf
s = s & "    FONT-SIZE: 11pt;" & vbCrLf
s = s & "    COLOR: #000000;" & vbCrLf
s = s & "    FONT-FAMILY: arial,helvetica,verdana;" & vbCrLf
s = s & "}" & vbCrLf
s = s & ".clsUserNameText" & vbCrLf
s = s & "{" & vbCrLf
s = s & "    FONT-WEIGHT: bold;" & vbCrLf
s = s & "    FONT-SIZE: 8pt;" & vbCrLf
s = s & "    FONT-FAMILY: Verdana;" & vbCrLf
s = s & "    CURSOR: default;" & vbCrLf
s = s & "    COLOR: blue;" & vbCrLf
s = s & "}" & vbCrLf
s = s & ".clsSelectList" & vbCrLf
s = s & "{" & vbCrLf
s = s & "    FONT-SIZE: 8pt;" & vbCrLf
s = s & "    FONT-FAMILY: verdana,arial,helvetica;" & vbCrLf
s = s & "}" & vbCrLf
s = s & ".clsMSelectList" & vbCrLf
s = s & "{" & vbCrLf
s = s & "    FONT-SIZE: 8pt;" & vbCrLf
s = s & "    CURSOR: default;" & vbCrLf
s = s & "    FONT-FAMILY: verdana,arial,helvetica;" & vbCrLf
s = s & "    BACKGROUND-COLOR: #ffffff;" & vbCrLf
s = s & "    BORDER-RIGHT: gray 1px solid;" & vbCrLf
s = s & "    BORDER-TOP: gray 1px solid;" & vbCrLf
s = s & "    BORDER-LEFT: gray 1px solid;" & vbCrLf
s = s & "    BORDER-BOTTOM: gray 1px solid;" & vbCrLf
s = s & "    OVERFLOW: hidden;" & vbCrLf
s = s & "}" & vbCrLf
s = s & ".clsMSelectButton" & vbCrLf
s = s & "{" & vbCrLf
s = s & "    CURSOR: default;" & vbCrLf
s = s & "    BACKGROUND-COLOR: #d3d3d3;" & vbCrLf
s = s & "    BORDER-RIGHT: gray 1px solid;" & vbCrLf
s = s & "    BORDER-TOP: gray 1px solid;" & vbCrLf
s = s & "    BORDER-BOTTOM: gray 1px solid;" & vbCrLf
s = s & "}" & vbCrLf
s = s & ".clsMSelectPane" & vbCrLf
s = s & "{" & vbCrLf
s = s & "    BORDER-RIGHT: gray 1px solid;" & vbCrLf
s = s & "    CURSOR: default;" & vbCrLf
s = s & "    FONT-SIZE: 8pt;" & vbCrLf
s = s & "    LEFT: 4px;" & vbCrLf
s = s & "    VISIBILITY: hidden;" & vbCrLf
s = s & "    BORDER-LEFT: gray 1px solid;" & vbCrLf
s = s & "    WIDTH: 210px;" & vbCrLf
s = s & "    COLOR: blue;" & vbCrLf
s = s & "    BORDER-BOTTOM: gray 1px solid;" & vbCrLf
s = s & "    FONT-FAMILY: Verdana;" & vbCrLf
s = s & "    POSITION: absolute;" & vbCrLf
s = s & "    BACKGROUND-COLOR: #ffffff;" & vbCrLf
s = s & "}" & vbCrLf
s = s & ".clsButton" & vbCrLf
s = s & "{" & vbCrLf
s = s & "    FONT-SIZE: 8pt;" & vbCrLf
s = s & "    FONT-FAMILY: verdana,arial,helvetica;" & vbCrLf
s = s & "}" & vbCrLf
s = s & ".clsTextbox" & vbCrLf
s = s & "{" & vbCrLf
s = s & "    FONT-SIZE: 8pt;" & vbCrLf
s = s & "    FONT-FAMILY: verdana,arial,helvetica;" & vbCrLf
s = s & "}" & vbCrLf
s = s & ".clsLabelText" & vbCrLf
s = s & "{" & vbCrLf
s = s & "    FONT-SIZE: 8pt;" & vbCrLf
s = s & "    FONT-FAMILY: verdana,arial,helvetica;" & vbCrLf
s = s & "}" & vbCrLf
s = s & ".clsMenuLinkText" & vbCrLf
s = s & "{" & vbCrLf
s = s & "    FONT-SIZE: 8pt;" & vbCrLf
s = s & "    CURSOR: default;" & vbCrLf
s = s & "    COLOR: #a9a9a9;" & vbCrLf
s = s & "    FONT-FAMILY: verdana,arial,helvetica;" & vbCrLf
s = s & "}" & vbCrLf
s = s & ".clsPopMenuLinkText" & vbCrLf
s = s & "{" & vbCrLf
s = s & "    FONT-SIZE: 8pt;" & vbCrLf
s = s & "    CURSOR: default;" & vbCrLf
s = s & "    COLOR: #a9a9a9;" & vbCrLf
s = s & "    FONT-FAMILY: verdana,arial,helvetica;" & vbCrLf
s = s & "}" & vbCrLf
s = s & ".clsPopMenu" & vbCrLf
s = s & "{" & vbCrLf
s = s & "    BORDER-RIGHT: gray 1px solid;" & vbCrLf
s = s & "    BORDER-TOP: gray 1px solid;" & vbCrLf
s = s & "    Z-INDEX: 102;" & vbCrLf
s = s & "    VISIBILITY: hidden;" & vbCrLf
s = s & "    BORDER-LEFT: gray 1px solid;" & vbCrLf
s = s & "    BORDER-BOTTOM: gray 1px solid;" & vbCrLf
s = s & "    POSITION: absolute;" & vbCrLf
s = s & "    BACKGROUND-COLOR: #e0e0ff;" & vbCrLf
s = s & "}" & vbCrLf
s = s & ".clsCopyrightText" & vbCrLf
s = s & "{" & vbCrLf
s = s & "    FONT-SIZE: 7pt;" & vbCrLf
s = s & "    COLOR: #000000;" & vbCrLf
s = s & "    FONT-FAMILY: Verdana;" & vbCrLf
s = s & "}" & vbCrLf
s = s & ".clsTableHeaderText" & vbCrLf
s = s & "{" & vbCrLf
s = s & "    FONT-SIZE: 8pt;" & vbCrLf
s = s & "    COLOR: #000000;" & vbCrLf
s = s & "    FONT-FAMILY: verdana, arial, helvetica;" & vbCrLf
s = s & "    BACKGROUND-COLOR: #e0e0ff;" & vbCrLf
s = s & "}" & vbCrLf
s = s & ".clsTableText" & vbCrLf
s = s & "{" & vbCrLf
s = s & "    FONT-SIZE: 8pt;" & vbCrLf
s = s & "    COLOR: #000000;" & vbCrLf
s = s & "    FONT-FAMILY: verdana,arial,helvetica;" & vbCrLf
s = s & "}" & vbCrLf
s = s & ".clsTableTextS" & vbCrLf
s = s & "{" & vbCrLf
s = s & "    FONT-SIZE: 8pt;" & vbCrLf
s = s & "    COLOR: #000000;" & vbCrLf
s = s & "    FONT-FAMILY: verdana,arial,helvetica;" & vbCrLf
s = s & "    BACKGROUND-COLOR: #f5f5f5;" & vbCrLf
s = s & "}" & vbCrLf
s = s & ".clsMenuHeader" & vbCrLf
s = s & "{" & vbCrLf
s = s & "    FONT-WEIGHT: bold;" & vbCrLf
s = s & "    FONT-SIZE: 8pt;" & vbCrLf
s = s & "    LEFT: 4px;" & vbCrLf
s = s & "    WIDTH: 210px;" & vbCrLf
s = s & "    CURSOR: hand;" & vbCrLf
s = s & "    FONT-FAMILY: Verdana;" & vbCrLf
s = s & "    POSITION: absolute;" & vbCrLf
s = s & "    HEIGHT: 15px;" & vbCrLf
s = s & "}" & vbCrLf
s = s & ".clsMenuHeaderInactive" & vbCrLf
s = s & "{" & vbCrLf
s = s & "    COLOR: blue;" & vbCrLf
s = s & "    BACKGROUND-COLOR: #cecece;" & vbCrLf
s = s & "}" & vbCrLf
s = s & ".clsMenuHeaderActive" & vbCrLf
s = s & "{" & vbCrLf
s = s & "    COLOR: #ffffff;" & vbCrLf
s = s & "    BACKGROUND-COLOR: blue;" & vbCrLf
s = s & "}" & vbCrLf
s = s & ".clsMenuPane" & vbCrLf
s = s & "{" & vbCrLf
s = s & "    BORDER-RIGHT: blue 1px solid;" & vbCrLf
s = s & "    FONT-SIZE: 8pt;" & vbCrLf
s = s & "    LEFT: 4px;" & vbCrLf
s = s & "    VISIBILITY: hidden;" & vbCrLf
s = s & "    BORDER-LEFT: blue 1px solid;" & vbCrLf
s = s & "    WIDTH: 210px;" & vbCrLf
s = s & "    COLOR: blue;" & vbCrLf
s = s & "    BORDER-BOTTOM: blue 1px solid;" & vbCrLf
s = s & "    FONT-FAMILY: Verdana;" & vbCrLf
s = s & "    POSITION: absolute;" & vbCrLf
s = s & "    BACKGROUND-COLOR: #ffffff;" & vbCrLf
s = s & "}" & vbCrLf
s = s & ".clsHoverButton" & vbCrLf
s = s & "{" & vbCrLf
s = s & "    BORDER-RIGHT: #aaaaaa 1px solid;" & vbCrLf
s = s & "    BORDER-TOP: #aaaaaa 1px solid;" & vbCrLf
s = s & "    FONT-WEIGHT: bold;" & vbCrLf
s = s & "    FONT-SIZE: 8pt;" & vbCrLf
s = s & "    BORDER-LEFT: #aaaaaa 1px solid;" & vbCrLf
s = s & "    WIDTH: 64px;" & vbCrLf
s = s & "    BORDER-BOTTOM: #aaaaaa 1px solid;" & vbCrLf
s = s & "    FONT-FAMILY: Verdana;" & vbCrLf
s = s & "    HEIGHT: 12px;" & vbCrLf
s = s & "}" & vbCrLf
s = s & ".clsEformHoverButton" & vbCrLf
s = s & "{" & vbCrLf
s = s & "    BORDER-RIGHT: #aaaaaa 1px solid;" & vbCrLf
s = s & "    BORDER-TOP: #aaaaaa 1px solid;" & vbCrLf
s = s & "    FONT-SIZE: 8pt;" & vbCrLf
s = s & "    BORDER-LEFT: #aaaaaa 1px solid;" & vbCrLf
s = s & "    WIDTH: 160px;" & vbCrLf
s = s & "    BORDER-BOTTOM: #aaaaaa 1px solid;" & vbCrLf
s = s & "    FONT-FAMILY: Verdana;" & vbCrLf
s = s & "    HEIGHT: 12px;" & vbCrLf
s = s & "}" & vbCrLf
s = s & ".clsVisitHoverButton" & vbCrLf
s = s & "{" & vbCrLf
s = s & "    FONT-SIZE: 8pt;" & vbCrLf
s = s & "    FONT-FAMILY: Verdana;" & vbCrLf
s = s & "    HEIGHT: 30px;" & vbCrLf
s = s & "}" & vbCrLf
s = s & ".clsHoverButtonInactive" & vbCrLf
s = s & "{" & vbCrLf
s = s & "    CURSOR: hand;" & vbCrLf
s = s & "    COLOR: gray;" & vbCrLf
s = s & "    BACKGROUND-COLOR: #eeeeee;" & vbCrLf
s = s & "}" & vbCrLf
s = s & ".clsHoverButtonActive" & vbCrLf
s = s & "{" & vbCrLf
s = s & "    CURSOR: hand;" & vbCrLf
s = s & "    COLOR: blue;" & vbCrLf
s = s & "    BACKGROUND-COLOR: #ffffff;" & vbCrLf
s = s & "}" & vbCrLf
s = s & ".clsHoverButtonSelected" & vbCrLf
s = s & "{" & vbCrLf
s = s & "    CURSOR: default;" & vbCrLf
s = s & "    COLOR: black;" & vbCrLf
s = s & "    BACKGROUND-COLOR: #ffffff;" & vbCrLf
s = s & "}" & vbCrLf
s = s & ".clsHoverButtonDisabled" & vbCrLf
s = s & "{" & vbCrLf
s = s & "    CURSOR: default;" & vbCrLf
s = s & "    COLOR: #ffffff;" & vbCrLf
s = s & "    BACKGROUND-COLOR: #eeeeee;" & vbCrLf
s = s & "}" & vbCrLf
s = s & ".clsSDVPlanned" & vbCrLf
s = s & "{" & vbCrLf
s = s & "    BORDER-RIGHT: green 1px dotted;" & vbCrLf
s = s & "    BORDER-TOP: green 1px dotted;" & vbCrLf
s = s & "    BORDER-LEFT: green 1px dotted;" & vbCrLf
s = s & "    BORDER-BOTTOM: green 1px dotted;" & vbCrLf
s = s & "}" & vbCrLf
s = s & ".clsSDVCompleted" & vbCrLf
s = s & "{" & vbCrLf
s = s & "    BORDER-RIGHT: green 1px solid;" & vbCrLf
s = s & "    BORDER-TOP: green 1px solid;" & vbCrLf
s = s & "    BORDER-LEFT: green 1px solid;" & vbCrLf
s = s & "    BORDER-BOTTOM: green 1px solid;" & vbCrLf
s = s & "}" & vbCrLf
s = s & ".clsSDVQueried" & vbCrLf
s = s & "{" & vbCrLf
s = s & "    BORDER-RIGHT: red 2px dashed;" & vbCrLf
s = s & "    BORDER-TOP: red 2px dashed;" & vbCrLf
s = s & "    BORDER-LEFT: red 2px dashed;" & vbCrLf
s = s & "    BORDER-BOTTOM: red 2px dashed;" & vbCrLf
s = s & "}" & vbCrLf
s = s & ".clsErrorText" & vbCrLf
s = s & "{" & vbCrLf
s = s & "    FONT-SIZE: 9pt;" & vbCrLf
s = s & "    COLOR: #000000;" & vbCrLf
s = s & "    FONT-FAMILY: verdana,arial,sans-serif;" & vbCrLf
s = s & "}" & vbCrLf
s = s & ".clsMessageText" & vbCrLf
s = s & "{" & vbCrLf
s = s & "    FONT-SIZE: 9pt;" & vbCrLf
s = s & "    COLOR: #000000;" & vbCrLf
s = s & "    FONT-FAMILY: verdana,arial,sans-serif;" & vbCrLf
s = s & "}" & vbCrLf
s = s & ".clsProcessingMessageBox" & vbCrLf
s = s & "{" & vbCrLf
s = s & "    BORDER-RIGHT: gray 1px solid;" & vbCrLf
s = s & "    BORDER-TOP: gray 1px solid;" & vbCrLf
s = s & "    LEFT: 50px;" & vbCrLf
s = s & "    BORDER-LEFT: gray 1px solid;" & vbCrLf
s = s & "    WIDTH: 300px;" & vbCrLf
s = s & "    BORDER-BOTTOM: gray 1px solid;" & vbCrLf
s = s & "    POSITION: absolute;" & vbCrLf
s = s & "    TOP: 50px;" & vbCrLf
s = s & "    HEIGHT: 100px;" & vbCrLf
s = s & "    BACKGROUND-COLOR: #d3d3d3;" & vbCrLf
s = s & "}" & vbCrLf
s = s & ".clsScheduleHeadingText" & vbCrLf
s = s & "{" & vbCrLf
s = s & "    FONT-WEIGHT: bold;" & vbCrLf
s = s & "    FONT-SIZE: 8pt;" & vbCrLf
s = s & "    COLOR: #000000;" & vbCrLf
s = s & "    FONT-FAMILY: verdana,arial,helvetica;" & vbCrLf
s = s & "}" & vbCrLf
s = s & ".clsScheduleMenuLinkText" & vbCrLf
s = s & "{" & vbCrLf
s = s & "    FONT-SIZE: 10pt;" & vbCrLf
s = s & "    CURSOR: default;" & vbCrLf
s = s & "    COLOR: #a9a9a9;" & vbCrLf
s = s & "    FONT-FAMILY: verdana,arial,helvetica;" & vbCrLf
s = s & "}" & vbCrLf
s = s & ".clsScheduleBorder" & vbCrLf
s = s & "{" & vbCrLf
s = s & "    BACKGROUND-COLOR: #eeeeee;" & vbCrLf
s = s & "}" & vbCrLf
s = s & ".clsScheduleVisitText" & vbCrLf
s = s & "{" & vbCrLf
s = s & "    FONT-SIZE: 8pt;" & vbCrLf
s = s & "    COLOR: gray;" & vbCrLf
s = s & "    FONT-FAMILY: verdana,arial,helvetica;" & vbCrLf
s = s & "}" & vbCrLf
s = s & ".clsScheduleEformText" & vbCrLf
s = s & "{" & vbCrLf
s = s & "    FONT-SIZE: 8pt;" & vbCrLf
s = s & "    COLOR: gray;" & vbCrLf
s = s & "    FONT-FAMILY: verdana,arial,helvetica;" & vbCrLf
s = s & "}" & vbCrLf
s = s & ".clsScheduleVisitDateText" & vbCrLf
s = s & "{" & vbCrLf
s = s & "    FONT-SIZE: 7pt;" & vbCrLf
s = s & "    COLOR: #000000;" & vbCrLf
s = s & "    FONT-FAMILY: verdana,arial,helvetica;" & vbCrLf
s = s & "}" & vbCrLf
s = s & ".clsScheduleEformLabelText" & vbCrLf
s = s & "{" & vbCrLf
s = s & "    FONT-SIZE: 7pt;" & vbCrLf
s = s & "    COLOR: #000000;" & vbCrLf
s = s & "    FONT-FAMILY: verdana,arial,helvetica;" & vbCrLf
s = s & "}" & vbCrLf
s = s & ".clsScheduleEformBorder" & vbCrLf
s = s & "{" & vbCrLf
s = s & "    BORDER-RIGHT: #aaaaaa 1px solid;" & vbCrLf
s = s & "    BORDER-TOP: #aaaaaa 1px solid;" & vbCrLf
s = s & "    BORDER-LEFT: #aaaaaa 1px solid;" & vbCrLf
s = s & "    BORDER-BOTTOM: #aaaaaa 1px solid;" & vbCrLf
s = s & "}" & vbCrLf
s = s & ".clsMainBorderText" & vbCrLf
s = s & "{" & vbCrLf
s = s & "    FONT-WEIGHT: bold;" & vbCrLf
s = s & "    FONT-SIZE: 8pt;" & vbCrLf
s = s & "    COLOR: #ffffff;" & vbCrLf
s = s & "    FONT-FAMILY: verdana,arial,helvetica;" & vbCrLf
s = s & "}" & vbCrLf
s = s & ".ROWOVER" & vbCrLf
s = s & "{" & vbCrLf
s = s & "    BEHAVIOR: url(../script/rowover_js.htc)" & vbCrLf
s = s & "}" & vbCrLf
s = s & ".LINK" & vbCrLf
s = s & "{" & vbCrLf
s = s & "    CURSOR: hand" & vbCrLf
s = s & "}" & vbCrLf
s = s & ".clsNRCTC" & vbCrLf
s = s & "{" & vbCrLf
s = s & "    BORDER-RIGHT: black 1px solid;" & vbCrLf
s = s & "    BORDER-TOP: black 1px solid;" & vbCrLf
s = s & "    FONT-WEIGHT: bold;" & vbCrLf
s = s & "    FONT-SIZE: 9pt;" & vbCrLf
s = s & "    BORDER-LEFT: black 1px solid;" & vbCrLf
s = s & "    COLOR: #000000;" & vbCrLf
s = s & "    BORDER-BOTTOM: black 1px solid;" & vbCrLf
s = s & "    FONT-FAMILY: verdana,arial,sans-serif;" & vbCrLf
s = s & "}" & vbCrLf
s = s & ".abs" & vbCrLf
s = s & "{" & vbCrLf
s = s & "    BORDER-WIDTH: 1;" & vbCrLf
s = s & "    BORDER-COLOR: red;" & vbCrLf
s = s & "    PADDING: 0;" & vbCrLf
s = s & "    MARGIN: 0;" & vbCrLf
s = s & "    POSITION: absolute;" & vbCrLf
s = s & "    Z-INDEX: 100;" & vbCrLf
s = s & "}" & vbCrLf
s = s & ".clsArezzoDecisionCaption" & vbCrLf
s = s & "{" & vbCrLf
s = s & "    FONT-WEIGHT: bolder;" & vbCrLf
s = s & "    FONT-SIZE: 12pt;" & vbCrLf
s = s & "    COLOR: purple;" & vbCrLf
s = s & "    FONT-FAMILY: helvetica, arial;" & vbCrLf
s = s & "    TEXT-DECORATION: none" & vbCrLf
s = s & "}" & vbCrLf
s = s & ".clsArezzoBestCandidateCaption" & vbCrLf
s = s & "{" & vbCrLf
s = s & "    PADDING-RIGHT: 0.5em;" & vbCrLf
s = s & "    PADDING-LEFT: 0.5em;" & vbCrLf
s = s & "    FONT-WEIGHT: bolder;" & vbCrLf
s = s & "    FONT-SIZE: 12px;" & vbCrLf
s = s & "    PADDING-BOTTOM: 0.5em;" & vbCrLf
s = s & "    COLOR: purple;" & vbCrLf
s = s & "    PADDING-TOP: 0.5em;" & vbCrLf
s = s & "    FONT-FAMILY: helvetica,arial;" & vbCrLf
s = s & "    TEXT-DECORATION: none" & vbCrLf
s = s & "}" & vbCrLf
s = s & ".clsArezzoCandidateCaption" & vbCrLf
s = s & "{" & vbCrLf
s = s & "    PADDING-RIGHT: 0.5em;" & vbCrLf
s = s & "    PADDING-LEFT: 0.5em;" & vbCrLf
s = s & "    FONT-WEIGHT: bolder;" & vbCrLf
s = s & "    FONT-SIZE: 12px;" & vbCrLf
s = s & "    PADDING-BOTTOM: 0.5em;" & vbCrLf
s = s & "    COLOR: purple;" & vbCrLf
s = s & "    PADDING-TOP: 0.5em;" & vbCrLf
s = s & "    FONT-FAMILY: helvetica,arial;" & vbCrLf
s = s & "    TEXT-DECORATION: none" & vbCrLf
s = s & "}" & vbCrLf
s = s & ".clsArezzoArgCaption" & vbCrLf
s = s & "{" & vbCrLf
s = s & "    FONT-SIZE: 10pt;" & vbCrLf
s = s & "    COLOR: black;" & vbCrLf
s = s & "    FONT-FAMILY: helvetica,arial;" & vbCrLf
s = s & "    POSITION: relative;" & vbCrLf
s = s & "    TEXT-DECORATION: underline;" & vbCrLf
s = s & "}" & vbCrLf
s = s & ".clsArezzoArg" & vbCrLf
s = s & "{" & vbCrLf
s = s & "    FONT-SIZE: 8pt;" & vbCrLf
s = s & "    COLOR: blue;" & vbCrLf
s = s & "    FONT-FAMILY: helvetica,arial;" & vbCrLf
s = s & "    POSITION: relative;" & vbCrLf
s = s & "    TEXT-DECORATION: none;" & vbCrLf
s = s & "}" & vbCrLf
s = s & ".clsArezzoActionCaption" & vbCrLf
s = s & "{" & vbCrLf
s = s & "    FONT-WEIGHT: bolder;" & vbCrLf
s = s & "    FONT-SIZE: 12pt;" & vbCrLf
s = s & "    PADDING-BOTTOM: 0.2em;" & vbCrLf
s = s & "    COLOR: purple;" & vbCrLf
s = s & "    FONT-FAMILY: helvetica, arial;" & vbCrLf
s = s & "    TEXT-DECORATION: none" & vbCrLf
s = s & "}" & vbCrLf
s = s & ".clsArezzoActionProcedure" & vbCrLf
s = s & "{" & vbCrLf
s = s & "    FONT-SIZE: 10pt;" & vbCrLf
s = s & "    COLOR: black;" & vbCrLf
s = s & "    FONT-FAMILY: helvetica, arial;" & vbCrLf
s = s & "    TEXT-DECORATION: none" & vbCrLf
s = s & "}" & vbCrLf
s = s & ".clsArezzoHeading" & vbCrLf
s = s & "{" & vbCrLf
s = s & "    FONT-SIZE: 12pt;" & vbCrLf
s = s & "    FONT-WEIGHT: bold;" & vbCrLf
s = s & "    COLOR: #000080;" & vbCrLf
s = s & "    PADDING-TOP: 0.1em;" & vbCrLf
s = s & "    FONT-FAMILY: helvetica, arial" & vbCrLf
s = s & "}"
CompiledStyleSheetHTML = s
End Function
'-----------------------------------------------------------------------------
Public Function CompiledHoverButtonHTML() As String
'-----------------------------------------------------------------------------
Dim s As String
s = ""
s = s & "function fnInitialiseButton(sName,clsHover,clsUnHover,clsSelected,bInitialSelect)" & vbCrLf
s = s & "{" & vbCrLf
s = s & " var oClass = new Object();" & vbCrLf
s = s & " oClass.clsHover=clsHover;" & vbCrLf
s = s & " oClass.clsUnHover=clsUnHover;" & vbCrLf
s = s & " oClass.clsSelected=clsSelected;" & vbCrLf
s = s & " " & vbCrLf
s = s & " var aButtons=document.all[sName];" & vbCrLf
s = s & " for (var n=0;n<aButtons.length;n++)" & vbCrLf
s = s & " {" & vbCrLf
s = s & "         aButtons[n].ndx=n;" & vbCrLf
s = s & "         aButtons[n].bSelected=false;" & vbCrLf
s = s & "         aButtons[n].oClass=oClass;" & vbCrLf
s = s & " }" & vbCrLf
s = s & " if (bInitialSelect)" & vbCrLf
s = s & " {" & vbCrLf
s = s & "         for (n=0;n<aButtons.length;n++)" & vbCrLf
s = s & "         {" & vbCrLf
s = s & "                 var sPattern = /clsHoverButtonDisabled/;" & vbCrLf
s = s & "                 if (sPattern.exec(aButtons[n].className)==null)" & vbCrLf
s = s & "                 {" & vbCrLf
s = s & "                         aButtons[n].bSelected=true;" & vbCrLf
s = s & "                         return;" & vbCrLf
s = s & "                 }" & vbCrLf
s = s & "         }" & vbCrLf
s = s & " }" & vbCrLf
s = s & "}" & vbCrLf
s = s & "function fnGetSelectedButton(sName)" & vbCrLf
s = s & "{" & vbCrLf
s = s & " var oDiv;" & vbCrLf
s = s & " var aButtons=document.all[sName];" & vbCrLf
s = s & " for (var n=0;n<aButtons.length;n++)" & vbCrLf
s = s & " {" & vbCrLf
s = s & "         if (aButtons[n].bSelected==true)" & vbCrLf
s = s & "         {" & vbCrLf
s = s & "                 return aButtons[n];" & vbCrLf
s = s & "         }" & vbCrLf
s = s & " }" & vbCrLf
s = s & " return oDiv;" & vbCrLf
s = s & "}" & vbCrLf
s = s & "function fnSetButtonHover(oDiv)" & vbCrLf
s = s & "{" & vbCrLf
s = s & " if (!oDiv.bSelected)" & vbCrLf
s = s & " {" & vbCrLf
s = s & "         oDiv.className=oDiv.oClass.clsHover;" & vbCrLf
s = s & " }" & vbCrLf
s = s & "}" & vbCrLf
s = s & "function fnSetButtonUnHover(oDiv)" & vbCrLf
s = s & "{" & vbCrLf
s = s & " if (!oDiv.bSelected)" & vbCrLf
s = s & " {" & vbCrLf
s = s & "         oDiv.className=oDiv.oClass.clsUnHover;" & vbCrLf
s = s & " }" & vbCrLf
s = s & "}" & vbCrLf
s = s & "function fnSetButtonSelected(oDiv)" & vbCrLf
s = s & "{" & vbCrLf
s = s & " //get currently selected button, deselect it" & vbCrLf
s = s & " var oSelDiv=fnGetSelectedButton(oDiv.id);" & vbCrLf
s = s & " if (oSelDiv!=undefined) fnSetButtonUnSelected(oSelDiv);" & vbCrLf
s = s & " //set passed button selected" & vbCrLf
s = s & " oDiv.bSelected=true" & vbCrLf
s = s & " oDiv.className=oDiv.oClass.clsSelected;" & vbCrLf
s = s & " //call onclick handler" & vbCrLf
s = s & " fnDoButtonClick(oDiv.ndx);" & vbCrLf
s = s & "}" & vbCrLf
s = s & "function fnSetButtonUnSelected(oDiv)" & vbCrLf
s = s & "{" & vbCrLf
s = s & " oDiv.className=oDiv.oClass.clsUnHover;" & vbCrLf
s = s & " oDiv.bSelected=false;" & vbCrLf
s = s & "}"
CompiledHoverButtonHTML = s
End Function
'-----------------------------------------------------------------------------
Public Function CompiledappMenuLhHTML() As String
'-----------------------------------------------------------------------------
Dim s As String
s = ""
s = s & "//function initialises menus" & vbCrLf
s = s & "function fnInitialiseMenu()" & vbCrLf
s = s & "{" & vbCrLf
s = s & " for (var n=0;n<document.all[""divMenu""].length;n++)" & vbCrLf
s = s & " {" & vbCrLf
s = s & "         document.all[""divMenu""][n].ndx=n;" & vbCrLf
s = s & "         document.all[""divMenu""][n].isExpanded=false;" & vbCrLf
s = s & "         document.all[""divMenuPane""][n].style.visibility=""hidden"";" & vbCrLf
s = s & " }" & vbCrLf
s = s & "}" & vbCrLf
s = s & "//function sets passed menu to hovered style" & vbCrLf
s = s & "function fnSetMenuHover(oDiv)" & vbCrLf
s = s & "{" & vbCrLf
s = s & " if ((oDiv.isExpanded==undefined)||(oDiv.isExpanded==false))" & vbCrLf
s = s & " {" & vbCrLf
s = s & "         oDiv.className=""clsMenuHeader clsMenuHeaderActive"";" & vbCrLf
s = s & "         document.all[oDiv.id+""Img""][oDiv.ndx].src=""../img/exp_active.gif"";" & vbCrLf
s = s & " }" & vbCrLf
s = s & "}" & vbCrLf
s = s & "//function sets menu back to unhovered style" & vbCrLf
s = s & "function fnSetMenuUnHover(oDiv)" & vbCrLf
s = s & "{" & vbCrLf
s = s & " if ((oDiv.isExpanded==undefined)||(oDiv.isExpanded==false))" & vbCrLf
s = s & " {" & vbCrLf
s = s & "         oDiv.className=""clsMenuHeader clsMenuHeaderInactive"";" & vbCrLf
s = s & "         document.all[oDiv.id+""Img""][oDiv.ndx].src=""../img/exp_inactive.gif"";" & vbCrLf
s = s & " }" & vbCrLf
s = s & "}" & vbCrLf
s = s & "//function spaces menus based on whether they are expanded or collapsed" & vbCrLf
s = s & "function fnSpaceMenus()" & vbCrLf
s = s & "{" & vbCrLf
s = s & " var oDiv;" & vbCrLf
s = s & " var oDivDisplay;" & vbCrLf
s = s & " var oPrevDiv;" & vbCrLf
s = s & " var oPrevDivDisplay;" & vbCrLf
s = s & " var nTop=0;" & vbCrLf
s = s & " " & vbCrLf
s = s & " //get top of first menu header" & vbCrLf
s = s & " nTop+=document.all[""divMenu""][0].offsetTop;" & vbCrLf
s = s & " //loop through menu headers, missing first and last" & vbCrLf
s = s & " for (n=1;n<=document.all[""divMenu""].length-1;n++)" & vbCrLf
s = s & " {" & vbCrLf
s = s & "         //get current menu header and previous menu header" & vbCrLf
s = s & "         oDiv=document.all[""divMenu""][n];" & vbCrLf
s = s & "         oDivDisplay=document.all[""divMenuPane""][n];" & vbCrLf
s = s & "         oPrevDiv=document.all[""divMenu""][(n-1)];" & vbCrLf
s = s & "         oPrevDivDisplay=document.all[""divMenuPane""][(n-1)];" & vbCrLf
s = s & "         //get bottom of previous menu header" & vbCrLf
s = s & "         nTop+=oPrevDiv.offsetHeight;" & vbCrLf
s = s & "         if ((oPrevDiv.isExpanded!=undefined)&&(oPrevDiv.isExpanded!=false))" & vbCrLf
s = s & "         {" & vbCrLf
s = s & "                 //if previous menu header is expanded, add height of display pane" & vbCrLf
s = s & "                 nTop+=oPrevDivDisplay.offsetHeight;" & vbCrLf
s = s & "         }" & vbCrLf
s = s & "         //add height spacer" & vbCrLf
s = s & "         nTop+=10;" & vbCrLf
s = s & "         //set current menu header top to calculated position" & vbCrLf
s = s & "         oDiv.style.top=nTop;" & vbCrLf
s = s & "         if (oDiv.isExpanded)" & vbCrLf
s = s & "         {" & vbCrLf
s = s & "                 //set current display pane top to calculated position + height of menu header" & vbCrLf
s = s & "                 oDivDisplay.style.top=oDivDisplay.style.top=nTop+oDiv.offsetHeight" & vbCrLf
s = s & "         }" & vbCrLf
s = s & "         else" & vbCrLf
s = s & "         {" & vbCrLf
s = s & "                 //shift display pane to top of page to avoid scrollbars appearing when pane is hidden" & vbCrLf
s = s & "                 oDivDisplay.style.top=oDivDisplay.style.top=0;" & vbCrLf
s = s & "                 if (oDiv.name==""search"") " & vbCrLf
s = s & "                 {" & vbCrLf
s = s & "                         //search pane, special case" & vbCrLf
s = s & "                         fnHideSearch();" & vbCrLf
s = s & "                         oDivDisplay.style.height=10;" & vbCrLf
s = s & "                 }" & vbCrLf
s = s & "         }" & vbCrLf
s = s & " }       " & vbCrLf
s = s & "}" & vbCrLf
s = s & "//function expands menu (shows display div)" & vbCrLf
s = s & "function fnExpandMenu(oDiv)" & vbCrLf
s = s & "{" & vbCrLf
s = s & " oDiv.className=""clsMenuHeader clsMenuHeaderActive"";" & vbCrLf
s = s & " document.all[""divMenuImg""][oDiv.ndx].src=""../img/col_active.gif"";" & vbCrLf
s = s & " document.all[""divMenuPane""][oDiv.ndx].style.visibility=""visible"";" & vbCrLf
s = s & " oDiv.isExpanded=true;" & vbCrLf
s = s & " fnSpaceMenus();" & vbCrLf
s = s & "}" & vbCrLf
s = s & "//function collapses menu (hides display div)" & vbCrLf
s = s & "function fnCollapseMenu(oDiv)" & vbCrLf
s = s & "{" & vbCrLf
s = s & " document.all[""divMenuPane""][oDiv.ndx].style.visibility=""hidden"";" & vbCrLf
s = s & " oDiv.className=""clsMenuHeader clsMenuHeaderInactive"";" & vbCrLf
s = s & " document.all[""divMenuImg""][oDiv.ndx].src=""../img/exp_inactive.gif"";" & vbCrLf
s = s & " oDiv.isExpanded=false;" & vbCrLf
s = s & " fnSetMenuHover(oDiv);" & vbCrLf
s = s & " fnSpaceMenus();" & vbCrLf
s = s & "}" & vbCrLf
s = s & "//function toggles menus between collapsed and expanded" & vbCrLf
s = s & "function fnToggleMenu(oDiv)" & vbCrLf
s = s & "{" & vbCrLf
s = s & " if ((oDiv.isExpanded==undefined)||(oDiv.isExpanded==false))" & vbCrLf
s = s & " {" & vbCrLf
s = s & "         fnExpandMenu(oDiv);" & vbCrLf
s = s & " }" & vbCrLf
s = s & " else if (oDiv.isExpanded==true)" & vbCrLf
s = s & " {" & vbCrLf
s = s & "         fnCollapseMenu(oDiv);" & vbCrLf
s = s & " }" & vbCrLf
s = s & "}///////////////////////////////////////////////////////////////////////////////////////////" & vbCrLf
s = s & "//" & vbCrLf
s = s & "//       (c) InferMed 2003" & vbCrLf
s = s & "//" & vbCrLf
s = s & "//       MenuLh event handlers" & vbCrLf
s = s & "//" & vbCrLf
s = s & "///////////////////////////////////////////////////////////////////////////////////////////" & vbCrLf
s = s & "" & vbCrLf
s = s & "var oMain=window.parent.window.frames[4];" & vbCrLf
s = s & "var sDel1=""|"";" & vbCrLf
s = s & "var sDel2=""`"";" & vbCrLf
s = s & "var undefined;" & vbCrLf
s = s & "" & vbCrLf
s = s & "function fnSetVisible(sID,bVisible)" & vbCrLf
s = s & "{" & vbCrLf
s = s & " document.all[sID].style.visibility=(bVisible)? ""visible"":""hidden"";" & vbCrLf
s = s & "}" & vbCrLf
s = s & "function fnSetTop(sID,nTop)" & vbCrLf
s = s & "{" & vbCrLf
s = s & " document.all[sID].style.top=nTop;" & vbCrLf
s = s & "}        " & vbCrLf
s = s & "//function toggles search panes visible/hidden" & vbCrLf
s = s & "function fnToggleSearch(oDiv)" & vbCrLf
s = s & "{" & vbCrLf
s = s & " if (oDiv.isExpanded)" & vbCrLf
s = s & " {" & vbCrLf
s = s & "         var oSelDiv=fnGetSelectedButton(""divSearchBtn"")" & vbCrLf
s = s & "         if (oSelDiv!=undefined) fnSetButtonSelected(oSelDiv)" & vbCrLf
s = s & " }" & vbCrLf
s = s & " else" & vbCrLf
s = s & " {" & vbCrLf
s = s & "         fnHideSearch();" & vbCrLf
s = s & " }" & vbCrLf
s = s & "}" & vbCrLf
s = s & "function fnHideSearch()" & vbCrLf
s = s & "{" & vbCrLf
s = s & " fnSetVisible(""searchDiv0"",0); //refresh button,study,site,subject label" & vbCrLf
s = s & " fnSetVisible(""searchDiv1"",0); //visit,eform,question" & vbCrLf
s = s & " fnSetVisible(""searchDiv2"",0); //question status checkboxes" & vbCrLf
s = s & " fnSetVisible(""searchDiv3"",0); //before,after,time label" & vbCrLf
s = s & " fnSetVisible(""searchDiv4"",0); //raised,responded,closed" & vbCrLf
s = s & " fnSetVisible(""searchDiv5"",0); //planned,done,queried,cancelled" & vbCrLf
s = s & " fnSetVisible(""searchDiv6"",0); //public,private" & vbCrLf
s = s & " fnSetVisible(""searchDiv8"",0); //subject,visit,eform,question" & vbCrLf
s = s & " fnSetVisible(""searchDiv9"",0); //disc,sdv,note" & vbCrLf
s = s & " fnSetVisible(""searchDiv10"",0); //locked,frozen" & vbCrLf
s = s & " fnSetVisible(""searchDiv11"",0); //comment" & vbCrLf

If gbClinicalCoding Then
s = s & " fnSetVisible(""searchDiv12"",0);" & vbCrLf
s = s & " fnSetTop(""searchDiv12"",0);" & vbCrLf
End If

s = s & " fnSetTop(""searchDiv1"",0);" & vbCrLf
s = s & " fnSetTop(""searchDiv2"",0)" & vbCrLf
s = s & " fnSetTop(""searchDiv3"",0)" & vbCrLf
s = s & " fnSetTop(""searchDiv4"",0)" & vbCrLf
s = s & " fnSetTop(""searchDiv5"",0)" & vbCrLf
s = s & " fnSetTop(""searchDiv6"",0)" & vbCrLf
s = s & " fnSetTop(""searchDiv8"",0)" & vbCrLf
s = s & " fnSetTop(""searchDiv9"",0)" & vbCrLf
s = s & " fnSetTop(""searchDiv10"",0)" & vbCrLf
s = s & " fnSetTop(""searchDiv11"",0)" & vbCrLf
s = s & " " & vbCrLf
s = s & "}" & vbCrLf
s = s & "//function called for search type button clicks. shows/hides search options" & vbCrLf
s = s & "function fnDoButtonClick(ndx)" & vbCrLf
s = s & "{" & vbCrLf
s = s & " var nSearchIndex;" & vbCrLf
s = s & " var nHeight;" & vbCrLf
s = s & " " & vbCrLf
s = s & " fnHideSearch();" & vbCrLf
s = s & " switch (ndx)" & vbCrLf
s = s & " {" & vbCrLf
s = s & "         case 0: //Disc" & vbCrLf
s = s & "                 fnSetTop(""searchDiv1"",136);" & vbCrLf
s = s & "                 fnSetTop(""searchDiv3"",235);" & vbCrLf
s = s & "                 fnSetTop(""searchDiv4"",290);" & vbCrLf
s = s & "                 fnSetVisible(""searchDiv0"",1);" & vbCrLf
s = s & "                 fnSetVisible(""searchDiv1"",1);" & vbCrLf
s = s & "                 fnSetVisible(""searchDiv3"",1);" & vbCrLf
s = s & "                 fnSetVisible(""searchDiv4"",1);" & vbCrLf
s = s & "                 nHeight=345;" & vbCrLf
s = s & "                 break;" & vbCrLf
s = s & "         case 1: //SDV" & vbCrLf
s = s & "                 fnSetTop(""searchDiv1"",136);           " & vbCrLf
s = s & "                 fnSetTop(""searchDiv3"",235);" & vbCrLf
s = s & "                 fnSetTop(""searchDiv5"",290);" & vbCrLf
s = s & "                 fnSetTop(""searchDiv8"",340);                                                                                                                                                                                                                                                                                                                                                                                                    " & vbCrLf
s = s & "                 fnSetVisible(""searchDiv0"",1);" & vbCrLf
s = s & "                 fnSetVisible(""searchDiv1"",1);" & vbCrLf
s = s & "                 fnSetVisible(""searchDiv3"",1);" & vbCrLf
s = s & "                 fnSetVisible(""searchDiv5"",1);" & vbCrLf
s = s & "                 fnSetVisible(""searchDiv8"",1);" & vbCrLf
s = s & "                 nHeight=395;" & vbCrLf
s = s & "                 break;" & vbCrLf
s = s & "         case 2: //Notes " & vbCrLf
s = s & "                 fnSetTop(""searchDiv1"",136);" & vbCrLf
s = s & "                 fnSetTop(""searchDiv3"",235);" & vbCrLf
s = s & "                 fnSetTop(""searchDiv6"",290);                                                                                                                                                                                                                                                                                                                                                                                                           " & vbCrLf
s = s & "                 fnSetVisible(""searchDiv0"",1);" & vbCrLf
s = s & "                 fnSetVisible(""searchDiv1"",1);" & vbCrLf
s = s & "                 fnSetVisible(""searchDiv3"",1);" & vbCrLf
s = s & "                 fnSetVisible(""searchDiv6"",1);" & vbCrLf
s = s & "                 nHeight=325;" & vbCrLf
s = s & "                 break;" & vbCrLf
s = s & "         case 3: //Subject" & vbCrLf
s = s & "                 fnSetVisible(""searchDiv0"",1);" & vbCrLf
s = s & "                 nHeight=140;" & vbCrLf
s = s & "                 break;" & vbCrLf
s = s & "         case 4: //Data" & vbCrLf
s = s & "                 fnSetTop(""searchDiv2"",136);" & vbCrLf

If gbClinicalCoding Then
s = s & "                 fnSetTop(""searchDiv12"",261);" & vbCrLf
s = s & "                 fnSetTop(""searchDiv9"",309);" & vbCrLf
s = s & "                 fnSetTop(""searchDiv10"",405);" & vbCrLf
s = s & "                 fnSetTop(""searchDiv1"",430);" & vbCrLf
s = s & "                 fnSetTop(""searchDiv3"",529);" & vbCrLf
s = s & "                 fnSetTop(""searchDiv11"",376);" & vbCrLf

s = s & "                 fnSetVisible(""searchDiv12"",1);" & vbCrLf
Else
s = s & "                 fnSetTop(""searchDiv9"",261);" & vbCrLf
s = s & "                 fnSetTop(""searchDiv10"",357);" & vbCrLf
s = s & "                 fnSetTop(""searchDiv1"",386);" & vbCrLf
s = s & "                 fnSetTop(""searchDiv3"",485);" & vbCrLf
s = s & "                 fnSetTop(""searchDiv11"",332);" & vbCrLf
End If

s = s & "                 fnSetVisible(""searchDiv0"",1);" & vbCrLf
s = s & "                 fnSetVisible(""searchDiv2"",1);  " & vbCrLf
s = s & "                 fnSetVisible(""searchDiv9"",1);  " & vbCrLf
s = s & "                 fnSetVisible(""searchDiv10"",1); " & vbCrLf
s = s & "                 fnSetVisible(""searchDiv1"",1);  " & vbCrLf
s = s & "                 fnSetVisible(""searchDiv3"",1);" & vbCrLf
s = s & "                 fnSetVisible(""searchDiv11"",1);" & vbCrLf

If gbClinicalCoding Then
s = s & "                 nHeight=588;" & vbCrLf
Else
s = s & "                 nHeight=540;" & vbCrLf
End If

s = s & "                 break;" & vbCrLf
s = s & "         case 5: // Audit" & vbCrLf
s = s & "                 fnSetTop(""searchDiv2"",136);" & vbCrLf

s = s & "                 fnSetTop(""searchDiv11"",261);" & vbCrLf
s = s & "                 fnSetTop(""searchDiv10"",287);" & vbCrLf
s = s & "                 fnSetTop(""searchDiv1"",315);" & vbCrLf
s = s & "                 fnSetTop(""searchDiv3"",414);" & vbCrLf

s = s & "                 fnSetVisible(""searchDiv0"",1);" & vbCrLf
s = s & "                 fnSetVisible(""searchDiv2"",1);  " & vbCrLf
s = s & "                 fnSetVisible(""searchDiv11"",1);  " & vbCrLf
s = s & "                 fnSetVisible(""searchDiv10"",1); " & vbCrLf
s = s & "                 fnSetVisible(""searchDiv1"",1);  " & vbCrLf
s = s & "                 fnSetVisible(""searchDiv3"",1);" & vbCrLf

s = s & "                 nHeight=469;" & vbCrLf


s = s & "                 break;" & vbCrLf
s = s & " }" & vbCrLf
s = s & " for (var n=0;n<document.all[""divMenu""].length-1;n++)" & vbCrLf
s = s & " {" & vbCrLf
s = s & "         if(document.all[""divMenu""][n].name==""search"")" & vbCrLf
s = s & "         {               " & vbCrLf
s = s & "                 nSearchIndex=n" & vbCrLf
s = s & "         }" & vbCrLf
s = s & " }" & vbCrLf
s = s & " document.all[""divMenuPane""][nSearchIndex].style.height=nHeight;" & vbCrLf
s = s & " fnSpaceMenus();" & vbCrLf
s = s & "}" & vbCrLf
s = s & "//function builds a url from the search criteria" & vbCrLf
s = s & "function fnSearch(bMonitor)" & vbCrLf
s = s & "{" & vbCrLf
s = s & " var sSt=fltSt.value;" & vbCrLf
s = s & " var sSi=fltSi.value;" & vbCrLf
s = s & " var sVi=fltVi.value;" & vbCrLf
s = s & " var sEf=fltEf.value;" & vbCrLf
s = s & " var sQu=fltQu.value;" & vbCrLf
s = s & " var sSj=fltLb.value;" & vbCrLf
s = s & " var sUs=fltUs.value;" & vbCrLf
s = s & " var sDi=fltDi.value;" & vbCrLf
s = s & " var sSd=fltSD.value;" & vbCrLf
s = s & " var sNo=fltNo.value;" & vbCrLf
s = s & " var sSs= (fltSs[0].checked)?""1"":""0"";" & vbCrLf
s = s & "     sSs+=(fltSs[1].checked)?""1"":""0"";" & vbCrLf
s = s & "     sSs+=(fltSs[2].checked)?""1"":""0"";" & vbCrLf
s = s & "     sSs+=(fltSs[3].checked)?""1"":""0"";" & vbCrLf
s = s & "     sSs+=(fltSs[4].checked)?""1"":""0"";" & vbCrLf
s = s & "     sSs+=(fltSs[5].checked)?""1"":""0"";" & vbCrLf
s = s & "     sSs+=(fltSs[6].checked)?""1"":""0"";" & vbCrLf
s = s & " var sLk=(fltLk[0].checked)?""1"":""0"";" & vbCrLf
s = s & "         sLk+=(fltLk[1].checked)?""1"":""0"";" & vbCrLf
s = s & " var sB4=fltB4[0].checked;" & vbCrLf
s = s & " var sTm=fltTm.value;" & vbCrLf
s = s & " var sDSs= (fltDSs[0].checked)?""1"":""0"";" & vbCrLf
s = s & "     sDSs+=(fltDSs[1].checked)?""1"":""0"";" & vbCrLf
s = s & "     sDSs+=(fltDSs[2].checked)?""1"":""0"";" & vbCrLf
s = s & " var sSSs= (fltSSs[0].checked)?""1"":""0"";" & vbCrLf
s = s & "         sSSs+=(fltSSs[1].checked)?""1"":""0"";" & vbCrLf
s = s & "         sSSs+=(fltSSs[2].checked)?""1"":""0"";" & vbCrLf
s = s & "         sSSs+=(fltSSs[3].checked)?""1"":""0"";" & vbCrLf
s = s & " var sNSs= (fltNSs[0].checked)?""1"":""0"";" & vbCrLf
s = s & "         sNSs+=(fltNSs[1].checked)?""1"":""0"";  " & vbCrLf
s = s & " var sCm=fltCm.value;" & vbCrLf
s = s & " var sObj= (fltObj[0].checked)?""1"":""0"";" & vbCrLf
s = s & "         sObj+=(fltObj[1].checked)?""1"":""0"";" & vbCrLf
s = s & "         sObj+=(fltObj[2].checked)?""1"":""0"";" & vbCrLf
s = s & "         sObj+=(fltObj[3].checked)?""1"":""0"";" & vbCrLf
s = s & "         var oSelDiv=fnGetSelectedButton(""divSearchBtn"");" & vbCrLf

If gbClinicalCoding Then
s = s & " var sCS=fltCS.value;" & vbCrLf
s = s & " var sDc=fltDc.value;" & vbCrLf
End If

s = s & " if (!fnOnlyLegalChars(sSj))" & vbCrLf
s = s & " {" & vbCrLf
s = s & "         alert(""Search string cannot contain the following characters: `|~\"""");" & vbCrLf
s = s & "         return;" & vbCrLf
s = s & " }" & vbCrLf
s = s & " " & vbCrLf
s = s & " switch (oSelDiv.ndx)" & vbCrLf
s = s & " {" & vbCrLf
s = s & "         case 0:" & vbCrLf
s = s & "                 if (sDSs==""000"")" & vbCrLf
s = s & "                 {       " & vbCrLf
s = s & "                         alert(""Please select a discrepancy search status"")" & vbCrLf
s = s & "                         return;" & vbCrLf
s = s & "                 }" & vbCrLf
s = s & "                 fnDiscUrl(sSt,sSi,sVi,sEf,sQu,sSj,sUs,sB4,sTm,sDSs);" & vbCrLf
s = s & "                 break;" & vbCrLf
s = s & "         case 1:" & vbCrLf
s = s & "                 if (sSSs==""0000"")" & vbCrLf
s = s & "                 {       " & vbCrLf
s = s & "                         alert(""Please select an SDV search status"")" & vbCrLf
s = s & "                         return;" & vbCrLf
s = s & "                 }" & vbCrLf
s = s & "                 if (sObj==""0000"")" & vbCrLf
s = s & "                 {       " & vbCrLf
s = s & "                         alert(""Please select an SDV scope status"")" & vbCrLf
s = s & "                         return;" & vbCrLf
s = s & "                 }" & vbCrLf
s = s & "                 fnSDVUrl(sSt,sSi,sVi,sEf,sQu,sSj,sUs,sB4,sTm,sSSs,sObj);" & vbCrLf
s = s & "                 break;" & vbCrLf
s = s & "         case 2:" & vbCrLf
s = s & "                 if (sNSs==""00"")" & vbCrLf
s = s & "                 {       " & vbCrLf
s = s & "                         alert(""Please select a note search status"")" & vbCrLf
s = s & "                         return;" & vbCrLf
s = s & "                 }" & vbCrLf
s = s & "                 fnNoteUrl(sSt,sSi,sVi,sEf,sQu,sSj,sUs,sB4,sTm,sNSs);" & vbCrLf
s = s & "                 break;" & vbCrLf
s = s & "         case 3:" & vbCrLf
s = s & "                 fnSubjectListUrl(sSt,sSi,sSj)" & vbCrLf
s = s & "                 break;" & vbCrLf
s = s & "         case 4:" & vbCrLf
s = s & "                 if (sSs==""0000000"")" & vbCrLf
s = s & "                 {       " & vbCrLf
s = s & "                         alert(""Please select a search status"")" & vbCrLf
s = s & "                         return;" & vbCrLf
s = s & "                 }" & vbCrLf
s = s & "                 if ((sSj=="""")&&(!bMonitor))" & vbCrLf
s = s & "                 {" & vbCrLf
s = s & "                         alert(""Please enter a subject label in the search criteria"");" & vbCrLf
s = s & "                         fltLb.focus();" & vbCrLf
s = s & "                         return;" & vbCrLf
s = s & "                 }" & vbCrLf

If gbClinicalCoding Then
s = s & "                 fnBrowserUrl(sSt,sSi,sVi,sEf,sQu,sSj,sUs,sSs,sLk,sB4,sTm,sCm,sDi,sSd,sNo,sCS,sDc,""1"");" & vbCrLf
Else
s = s & "                 fnBrowserUrl(sSt,sSi,sVi,sEf,sQu,sSj,sUs,sSs,sLk,sB4,sTm,sCm,sDi,sSd,sNo,0,"""",""1"");" & vbCrLf
End If

s = s & "                 break;" & vbCrLf
s = s & "         case 5:" & vbCrLf
s = s & "                 if (sSs==""0000000"")" & vbCrLf
s = s & "                 {       " & vbCrLf
s = s & "                         alert(""Please select a search status"")" & vbCrLf
s = s & "                         return;" & vbCrLf
s = s & "                 }" & vbCrLf
s = s & "                 if ((sSj=="""")&&(!bMonitor))" & vbCrLf
s = s & "                 {" & vbCrLf
s = s & "                         alert(""Please enter a subject label in the search criteria"");" & vbCrLf
s = s & "                         fltLb.focus();" & vbCrLf
s = s & "                         return;" & vbCrLf
s = s & "                 }" & vbCrLf

'If gbClinicalCoding Then
s = s & "                 fnBrowserUrl(sSt,sSi,sVi,sEf,sQu,sSj,sUs,sSs,sLk,sB4,sTm,sCm,"""","""","""","""","""",""2"");" & vbCrLf
'Else
's = s & "                 fnBrowserUrl(sSt,sSi,sVi,sEf,sQu,sSj,sUs,sSs,sLk,sB4,sTm,sCm,"""","""","""",""2"");" & vbCrLf
'End If

s = s & "                 break;" & vbCrLf
s = s & " }" & vbCrLf
s = s & "}" & vbCrLf
s = s & "function fnOnlyLegalChars(vValue)" & vbCrLf
s = s & "{" & vbCrLf
s = s & " var     sIllegalChars = /[`|~""]/;" & vbCrLf
s = s & " if (sIllegalChars.exec(vValue)!=null)" & vbCrLf
s = s & " {" & vbCrLf
s = s & "         return false;" & vbCrLf
s = s & " }" & vbCrLf
s = s & " else" & vbCrLf
s = s & " {" & vbCrLf
s = s & "         return true;" & vbCrLf
s = s & " }" & vbCrLf
s = s & "}" & vbCrLf
s = s & "function fnOnlyNumeric(sStr)" & vbCrLf
s = s & "{" & vbCrLf
s = s & " var sPattern = /[^0-9]/;" & vbCrLf
s = s & " return sPattern.exec(sStr);" & vbCrLf
s = s & "}" & vbCrLf
s = s & "//function fnLoadSelect(sName,sList,bClear,bCodeAndText)" & vbCrLf
s = s & "//{" & vbCrLf
s = s & "//       var oSelect=window.document.all[sName];" & vbCrLf
s = s & "//       " & vbCrLf
s = s & "//       if (sList!=undefined)" & vbCrLf
s = s & "//       {" & vbCrLf
s = s & "//               // ATN 23/1/2003 - use regular expressions to convert lists into SELECT OPTIONS" & vbCrLf
s = s & "//               sOptions = sList.replace(/\|/g, '</option><option value=');" & vbCrLf
s = s & "//               sOptions = sOptions.replace(/\`\d+/g, '');" & vbCrLf
s = s & "//               sOptions =  sOptions.replace(/`/g, '>');" & vbCrLf
s = s & "//" & vbCrLf
s = s & "//               // ATN 23/1/2003 - replace HTML directly" & vbCrLf
s = s & "//               if (bClear)" & vbCrLf
s = s & "//               {" & vbCrLf
s = s & "//                       oSelect.innerHTML = '';" & vbCrLf
s = s & "//                       oSelect.outerHTML = oSelect.outerHTML.replace(/\<\/SELECT\>/i,'<option value=')  +  sOptions + ""</select>"";" & vbCrLf
s = s & "//               }" & vbCrLf
s = s & "//               else" & vbCrLf
s = s & "//               {" & vbCrLf
s = s & "//                       oSelect.outerHTML = oSelect.outerHTML.replace(/\<\/SELECT\>/i,'<option value=') + oSelect.innerHTML +  sOptions  + ""</select>"";" & vbCrLf
s = s & "//               }" & vbCrLf
s = s & "//       }" & vbCrLf
s = s & "//       else" & vbCrLf
s = s & "//       {" & vbCrLf
s = s & "//               oSelect.innerHTML = '';" & vbCrLf
s = s & "//               alert(""Menu select list file missing for '"" + oSelect.name + ""'. Please generate HTML in MACRO System Admin"")" & vbCrLf
s = s & "//       }" & vbCrLf
s = s & "//}" & vbCrLf
s = s & "function fnLoadSelect(sName,sList,bInit)" & vbCrLf
s = s & "{" & vbCrLf
s = s & " var oS=fnPopSelect(sName);      " & vbCrLf
s = s & " if (oS!=null)" & vbCrLf
s = s & " {" & vbCrLf
s = s & "         oS.populate(sList,bInit);" & vbCrLf
s = s & "         if (sList==undefined)" & vbCrLf
s = s & "         {" & vbCrLf
s = s & "                 alert(""Menu select list file missing for '"" + sName + ""'. Please generate HTML in MACRO System Admin"")" & vbCrLf
s = s & "         }" & vbCrLf
s = s & " }" & vbCrLf
s = s & " else" & vbCrLf
s = s & " {" & vbCrLf
s = s & "         alert(""Select list ""+sName+"" not found"");" & vbCrLf
s = s & " }" & vbCrLf
s = s & "}" & vbCrLf
s = s & "//function reloads study specific selects with newly selected studys items" & vbCrLf
s = s & "function fnLoadStudy(lId)" & vbCrLf
s = s & "{" & vbCrLf
s = s & " fnLoadSelect(""fltVi"",lstVisits[lId],0);" & vbCrLf
s = s & " fnLoadSelect(""fltEf"",lstEForms[lId],0);" & vbCrLf
s = s & " fnLoadSelect(""fltQu"",lstQuestions[lId],1);" & vbCrLf
s = s & "}" & vbCrLf
s = s & "function fnPageLoadedWin()" & vbCrLf
s = s & "{" & vbCrLf
s = s & " fnInitialiseMenu(""divMenu"");" & vbCrLf
s = s & " fnInitialiseButton(""divSearchBtn"",""clsHoverButton clsHoverButtonActive"",""clsHoverButton clsHoverButtonInactive"",""clsHoverButton clsHoverButtonSelected"",true);" & vbCrLf
s = s & " fnSpaceMenus();" & vbCrLf
s = s & "}" & vbCrLf
s = s & "//check/uncheck option checkboxes - optFunctionKeys,optSymbols,optDateFormat,optSplitScreen,optSameForm" & vbCrLf
s = s & "function fnSetOptionChecked(sName,bChecked)" & vbCrLf
s = s & "{" & vbCrLf
s = s & " if (document.Form1.all[sName]!=undefined)" & vbCrLf
s = s & " {" & vbCrLf
s = s & "         document.Form1.all[sName].checked=bChecked;" & vbCrLf
s = s & " }" & vbCrLf
s = s & "}" & vbCrLf
s = s & "//reloads subject quicklist - passed delimited list of delimited subjects:" & vbCrLf
s = s & "//studyid|studyname|site|subjectid|subjectlabel`studyid|studyname|site|subjectid|subjectlabel" & vbCrLf
s = s & "function fnReloadQuickList(sList)" & vbCrLf
s = s & "{" & vbCrLf
s = s & " if((sList=="""")||(sList==undefined)) return;" & vbCrLf
s = s & " var aSubjects=sList.split(sDel2);" & vbCrLf
s = s & " var aSubject;" & vbCrLf
s = s & " var sLabel;" & vbCrLf
s = s & " var osHTML=new Array();" & vbCrLf
s = s & "" & vbCrLf
s = s & " osHTML.push(""<table id='tsubject' style='cursor:hand;' onmouseover='fnOnMouseOver(this,0);' onmouseout='fnOnMouseOut(this)' width='100%' class='clsTableText'>"");" & vbCrLf
s = s & "    for(var n=0;n<aSubjects.length;n++)" & vbCrLf
s = s & "    {" & vbCrLf
s = s & "         aSubject=aSubjects[n].split(sDel1);" & vbCrLf
s = s & "        sLabel=(aSubject[4]!="""")?aSubject[4]:""(""+aSubject[3]+"")"";" & vbCrLf
s = s & "        if (n%2)" & vbCrLf
s = s & "        {" & vbCrLf
s = s & "                 osHTML.push(""<tr height='10'>"");" & vbCrLf
s = s & "         }" & vbCrLf
s = s & "         else" & vbCrLf
s = s & "         {" & vbCrLf
s = s & "                 osHTML.push(""<tr class='clsTableTextS' height='10'>"");" & vbCrLf
s = s & "         }" & vbCrLf
s = s & "         osHTML.push(""<a style='text-decoration:none;' href='javascript:fnScheduleUrl(\""""+aSubject[0]+""\"",\""""+aSubject[2]+""\"",\""""+aSubject[3]+""\"");'>"");" & vbCrLf
s = s & "         osHTML.push(""<td>"");" & vbCrLf
s = s & "         osHTML.push(aSubject[1]+""/""+aSubject[2]+""/""+sLabel);" & vbCrLf
s = s & "         osHTML.push(""</td>"");" & vbCrLf
s = s & "         osHTML.push(""</a>"");" & vbCrLf
s = s & "         osHTML.push(""</tr>"");            " & vbCrLf
s = s & "" & vbCrLf
s = s & " }" & vbCrLf
s = s & "    osHTML.push(""</table>"");" & vbCrLf
s = s & " document.all[""divQL""].innerHTML=osHTML.join('');" & vbCrLf
s = s & " //fnInitZOrder must be called to sort select list layers after innerhtml change" & vbCrLf
s = s & " fnInitZOrder();" & vbCrLf
s = s & "}" & vbCrLf
s = s & "function fnAddToQuickList(sItem)" & vbCrLf
s = s & "{" & vbCrLf
s = s & " lstSubjects+=sDel2+sItem;               " & vbCrLf
s = s & " fnReloadQuickList(lstSubjects);" & vbCrLf
s = s & "}" & vbCrLf
s = s & "//sets date format label" & vbCrLf
s = s & "function fnSetDateFormatLabel(sLabel)" & vbCrLf
s = s & "{" & vbCrLf
s = s & " sLabel=(sLabel!="""")?""(""+sLabel+"")"":"""";" & vbCrLf
s = s & " document.all[""divDateLabel""].innerHTML=sLabel;" & vbCrLf
s = s & " fnInitZOrder();" & vbCrLf
s = s & "}" & vbCrLf
s = s & "//displays update password window" & vbCrLf
s = s & "function fnChangePassword(sUser)" & vbCrLf
s = s & "{" & vbCrLf
s = s & " var sRtn=window.showModalDialog('DialogChangePassword.asp?exp=&name='+sUser,'','dialogHeight:300px; dialogWidth:500px; center:yes; status:0; dependent,scrollbars');" & vbCrLf
s = s & "}" & vbCrLf
s = s & "//displays db lock admin window" & vbCrLf
s = s & "function fnReleaseLocks()" & vbCrLf
s = s & "{" & vbCrLf
s = s & " var sRtn=window.showModalDialog('DialogLockAdmin.asp','','dialogHeight:400px; dialogWidth:700px; center:yes; status:0; dependent,scrollbars');" & vbCrLf
s = s & "}" & vbCrLf
s = s & "//function updates task list item counter text" & vbCrLf
s = s & "//sName arg is <td> id tag without 'td' prefix" & vbCrLf
s = s & "function fnSetTaskListItemCounter(sName,sNum,bZ)" & vbCrLf
s = s & "{" & vbCrLf
s = s & " bZ=(bZ!=undefined)?bZ:false;" & vbCrLf
s = s & " var oTD=window.document.all[""td""+sName]" & vbCrLf
s = s & " if (oTD==undefined) return;" & vbCrLf
s = s & " var str=oTD.innerHTML;" & vbCrLf
s = s & " var sN = /\s\([0-9]*\)/" & vbCrLf
s = s & "         " & vbCrLf
s = s & " if (sN.exec(str)!=null);" & vbCrLf
s = s & " {" & vbCrLf
s = s & "         str = str.replace(sN,"" (""+sNum+"")"");" & vbCrLf
s = s & " }" & vbCrLf
s = s & " oTD.innerHTML=str;" & vbCrLf
s = s & " if (bZ) fnInitZOrder();" & vbCrLf
s = s & "}" & vbCrLf
s = s & "//function enables/disables tasklist items" & vbCrLf
s = s & "//sName arg is <td> id tag without 'td' prefix" & vbCrLf
s = s & "var aJS = new Array();" & vbCrLf
s = s & "function fnEnableTaskListItem(sName,bEnable)" & vbCrLf
s = s & "{" & vbCrLf
s = s & " var oTD=window.document.all[""td""+sName]" & vbCrLf
s = s & " if (oTD==undefined) return;" & vbCrLf
s = s & " var str=oTD.innerHTML;" & vbCrLf
s = s & " var sStartA = /<[Aa][^>]*>/" & vbCrLf
s = s & " var sEndA = /<\/[Aa]>/" & vbCrLf
s = s & " " & vbCrLf
s = s & " if (bEnable)" & vbCrLf
s = s & " {" & vbCrLf
s = s & "         if ((sStartA.exec(str)==null)&&(aJS[sName]!=undefined))" & vbCrLf
s = s & "         {" & vbCrLf
s = s & "                 oTD.innerHTML=aJS[sName]+str+""</a>"";" & vbCrLf
s = s & "         }" & vbCrLf
s = s & " }" & vbCrLf
s = s & " else" & vbCrLf
s = s & " {" & vbCrLf
s = s & "         if (sStartA.exec(str)!=null)" & vbCrLf
s = s & "         {" & vbCrLf
s = s & "                 aJS[sName]=sStartA.exec(str);" & vbCrLf
s = s & "                 str = str.replace(sStartA,"""");" & vbCrLf
s = s & "                 str = str.replace(sEndA,"""");" & vbCrLf
s = s & "                 oTD.innerHTML=str;" & vbCrLf
s = s & "         }" & vbCrLf
s = s & " }" & vbCrLf
s = s & " //fnInitZOrder();" & vbCrLf
s = s & "}" & vbCrLf
s = s & "function fnShowLegend(bSymbol,bFunction)" & vbCrLf
s = s & "{" & vbCrLf
s = s & " var nS=(bSymbol)?70:0;" & vbCrLf
s = s & " var nF=(bFunction)?32:0;" & vbCrLf
s = s & " window.parent.document.all['f1'].rows='27,*,'+nS+','+nF;" & vbCrLf
s = s & "}" & vbCrLf
s = s & "" & vbCrLf
s = s & "function fnRegisterSubject()" & vbCrLf
s = s & "{" & vbCrLf
s = s & " var sState=oMain.fnGetAppState(0)" & vbCrLf
s = s & " if ((sState!=undefined)&&((sState.substring(0,1)==""4"")||(sState.substring(0,1)==""5"")))" & vbCrLf
s = s & " {" & vbCrLf
s = s & "         //schedule(4) or eform(5) is loaded" & vbCrLf
s = s & "         if (confirm(""This subject previously failed to register successfully.\nWould you like to try registration again?""))" & vbCrLf
s = s & "         {" & vbCrLf
s = s & "                 var sRtn=window.showModalDialog('DialogRegister.asp?state='+sState,'','dialogHeight:300px; dialogWidth:500px; center:yes; status:0; dependent,scrollbars');" & vbCrLf
s = s & "                 fnEnableTaskListItem(""RS"",false);" & vbCrLf
s = s & "         }" & vbCrLf
s = s & " }" & vbCrLf
s = s & "}"
CompiledappMenuLhHTML = s
End Function
'-----------------------------------------------------------------------------
Public Function CompiledappFooterLhHTML() As String
'-----------------------------------------------------------------------------
Dim s As String
s = ""
s = s & "" & vbCrLf
s = s & "" & vbCrLf
s = s & "" & vbCrLf
s = s & "" & vbCrLf
s = s & " <HTML>" & vbCrLf
s = s & " <HEAD>" & vbCrLf
s = s & "<!--r-->" & vbCrLf
s = s & " <link rel=""stylesheet"" HREF=""../style/MACRO1.css"" type=""text/css"">" & vbCrLf
s = s & " <!-- #include file=""HandleBrowserEvents.asp"" -->" & vbCrLf
s = s & "<!--r-->" & vbCrLf
s = s & " <TITLE></TITLE>" & vbCrLf
s = s & " </HEAD>" & vbCrLf
s = s & " <BODY bgcolor=""#e0e0ff"" >" & vbCrLf
s = s & "   <div style=""position:absolute; left:4; top:10;"">" & vbCrLf
s = s & "   <table class=""clsCopyrightText"" width=""100%"" border=""0"">" & vbCrLf
s = s & "       <tr><td align=""center""><a href=""http://www.infermed.com"" target=""_new""><img src=""../img/macrologo2.gif"" border=""0""><a></td></tr>" & vbCrLf
s = s & "       <tr><td align=""center"">&copy; <i>Infer</i>Med Limited, 2008<td></tr>" & vbCrLf
s = s & "     </table>" & vbCrLf
s = s & "   </div>" & vbCrLf
s = s & " </BODY>" & vbCrLf
s = s & " </HTML>" & vbCrLf
s = s & ""
CompiledappFooterLhHTML = s
End Function
'-----------------------------------------------------------------------------
Public Function CompiledeFormLhHTML() As String
'-----------------------------------------------------------------------------
Dim s As String
s = ""
s = s & "<html>" & vbCrLf
s = s & "<head>" & vbCrLf
s = s & "<!--r--><!--r-->" & vbCrLf
s = s & "<!--r--><link rel=""stylesheet"" HREF=""../style/MACRO1.css"" type=""text/css""><!--r-->" & vbCrLf
s = s & "<!--r--><script language=""javascript"" src='../script/HoverButton1.js'></script><!--r-->" & vbCrLf
s = s & "<script language=""javascript"">" & vbCrLf
s = s & " var sDel1=""`"";" & vbCrLf
s = s & " var sDel2=""|"";" & vbCrLf
s = s & " var undefined;" & vbCrLf
s = s & "//<!--r-->" & vbCrLf
s = s & " function fnKeyDown()" & vbCrLf
s = s & " {" & vbCrLf
s = s & "         if ((event.keyCode<112)||(event.keyCode>123)) return;" & vbCrLf
s = s & "         event.returnValue=false;" & vbCrLf
s = s & "         event.keyCode=0;" & vbCrLf
s = s & " }" & vbCrLf
s = s & " document.onkeydown=fnKeyDown;" & vbCrLf
s = s & " document.oncontextmenu=fnContextMenu;" & vbCrLf
s = s & " function fnContextMenu(){return false};" & vbCrLf
s = s & " function fnDoButtonClick(sId)" & vbCrLf
s = s & " {" & vbCrLf
s = s & "         if (window.parent.frames[2].fnCheckCurrentField()) window.parent.frames[2].fnSave(""e""+sId);" & vbCrLf
s = s & " }" & vbCrLf
s = s & "//<!--r-->" & vbCrLf
s = s & " function fnPageLoaded()" & vbCrLf
s = s & " {" & vbCrLf
s = s & "         fnInitialiseButton(""divEform"",""clsEformHoverButton clsHoverButtonActive"",""clsEformHoverButton clsHoverButtonInactive"",""clsEformHoverButton clsHoverButtonSelected"");" & vbCrLf
s = s & " }" & vbCrLf
s = s & "" & vbCrLf
s = s & " function fnLoadEformBorder(sEformList,sSelectedEformTaskId)" & vbCrLf
s = s & " {" & vbCrLf
s = s & "         //call this to load menu" & vbCrLf
s = s & "         var sHtml;" & vbCrLf
s = s & "         var aItem;" & vbCrLf
s = s & "         var aList=sEformList.split(sDel1);" & vbCrLf
s = s & "         " & vbCrLf
s = s & "         sHtml =""<table width='170' border='0' cellpadding='0' cellspacing='0' valign='top' align='left'>""" & vbCrLf
s = s & "         for (var n=0;n<aList.length;n++)" & vbCrLf
s = s & "         {" & vbCrLf
s = s & "                 aItem=aList[n].split(sDel2);" & vbCrLf
s = s & "                 sHtml+=""<tr>"";" & vbCrLf
s = s & "                 sHtml+=""<td valign='top' align='center'>"";" & vbCrLf
s = s & "                 sHtml+=(aItem[1]==sSelectedEformTaskId)?""<div title='""+aItem[2]+""' id='divEform' class='clsEformHoverButton clsHoverButtonSelected'>""+aItem[0]+""</div>"":""<div title='""+aItem[2]+""' onclick='fnDoButtonClick(\""""+aItem[1]+""\"");' onmouseout='javascript:fnSetButtonUnHover(this);' onmouseover='javascript:fnSetButtonHover(this);' id='divEform' class='clsEformHoverButton clsHoverButtonInactive'>""+aItem[0]+""</div>"";" & vbCrLf
s = s & "                 sHtml+=""</td>"";" & vbCrLf
s = s & "                 sHtml+=""</tr>"";" & vbCrLf
s = s & "                 sHtml+=""<tr height='10'><td></td></tr>"";" & vbCrLf
s = s & "         }" & vbCrLf
s = s & "         sHtml+=""</table>""" & vbCrLf
s = s & "         document.all.divEforms.innerHTML=sHtml;" & vbCrLf
s = s & "         fnPageLoaded();" & vbCrLf
s = s & " }" & vbCrLf
s = s & " function fnDisable()" & vbCrLf
s = s & " {" & vbCrLf
s = s & "         document.all.divEforms.innerHTML="""";" & vbCrLf
s = s & " }" & vbCrLf
s = s & "</script>" & vbCrLf
s = s & "</head>" & vbCrLf
s = s & "<body class='clsScheduleBorder'>" & vbCrLf
s = s & "<div id=""divEforms""></div>" & vbCrLf
s = s & "</body>" & vbCrLf
s = s & "</html>" & vbCrLf
s = s & "" & vbCrLf
s = s & ""
CompiledeFormLhHTML = s
End Function
'-----------------------------------------------------------------------------
Public Function CompiledeFormTopHTML() As String
'-----------------------------------------------------------------------------
Dim s As String
s = ""
s = s & "<html>" & vbCrLf
s = s & "<head>" & vbCrLf
s = s & "<!--r--><!--r-->" & vbCrLf
s = s & "<!--r--><link rel=""stylesheet"" HREF=""../style/MACRO1.css"" type=""text/css""><!--r-->" & vbCrLf
s = s & "<!--r--><script language=""javascript"" src='../script/HoverButton1.js'></script><!--r-->" & vbCrLf
s = s & "<script language=""javascript"">" & vbCrLf
s = s & "" & vbCrLf
s = s & " var sDel1=""`"";" & vbCrLf
s = s & " var sDel2=""|"";" & vbCrLf
s = s & " var undefined;" & vbCrLf
s = s & " var pW=window.parent;" & vbCrLf
s = s & " " & vbCrLf
s = s & " function button_on (imgName)" & vbCrLf
s = s & "                                  {" & vbCrLf
s = s & "                document[imgName].src = ""../img/"" + imgName + ""on.gif"";" & vbCrLf
s = s & "                                                         }" & vbCrLf
s = s & "" & vbCrLf
s = s & " function button_off (imgName)" & vbCrLf
s = s & "                          {" & vbCrLf
s = s & "                document[imgName].src = ""../img/"" + imgName + "".gif"";                        " & vbCrLf
s = s & "                                 }" & vbCrLf
s = s & " function fnResize()" & vbCrLf
s = s & " {" & vbCrLf
s = s & "         if (document.body.clientWidth>180)" & vbCrLf
s = s & "         {" & vbCrLf
s = s & "                 document.all[""divScroll""].style.width=(document.body.clientWidth-180)" & vbCrLf
s = s & "         }" & vbCrLf
s = s & " }" & vbCrLf
s = s & "//<!--r-->" & vbCrLf
s = s & "window.onerror=fnError;" & vbCrLf
s = s & "function fnError(sMsg,sUrl,sLine)" & vbCrLf
s = s & "{" & vbCrLf
s = s & " switch (sLine)" & vbCrLf
s = s & " {" & vbCrLf
s = s & "         case 26:" & vbCrLf
s = s & "         case 27:" & vbCrLf
s = s & "                 //resize before page has loaded, suppress error. NOTE any lines added to this file may alter the error line in this case statement" & vbCrLf
s = s & "                 return true; break;" & vbCrLf
s = s & "         default:" & vbCrLf
s = s & "                 //other error, let IE report as normal" & vbCrLf
s = s & "                 return false;" & vbCrLf
s = s & " }" & vbCrLf
s = s & "}" & vbCrLf
s = s & " function fnKeyDown()" & vbCrLf
s = s & " {" & vbCrLf
s = s & "         if ((event.keyCode<112)||(event.keyCode>123)) return;" & vbCrLf
s = s & "         event.returnValue=false;" & vbCrLf
s = s & "         event.keyCode=0;" & vbCrLf
s = s & " }" & vbCrLf
s = s & " document.onkeydown=fnKeyDown;" & vbCrLf
s = s & " window.onresize=fnResize;" & vbCrLf
s = s & " function fnContextMenu(){return false};" & vbCrLf
s = s & " document.oncontextmenu=fnContextMenu;" & vbCrLf
s = s & " function fnSave(sId)" & vbCrLf
s = s & " {" & vbCrLf
s = s & "         window.parent.frames[2].fnSave(sId)" & vbCrLf
s = s & " }" & vbCrLf
s = s & " function fnClose()" & vbCrLf
s = s & " {" & vbCrLf
s = s & "         window.parent.frames[2].fnCancel();" & vbCrLf
s = s & " }" & vbCrLf
s = s & " function fnPrint()" & vbCrLf
s = s & " {" & vbCrLf
s = s & "         window.parent.frames[2].fnPrint();" & vbCrLf
s = s & " }" & vbCrLf
s = s & "//<!--r-->" & vbCrLf
s = s & " function fnPageLoaded()" & vbCrLf
s = s & " {" & vbCrLf
s = s & "         fnInitialiseButton(""divVisit"",""clsVisitHoverButton clsHoverButtonActive"",""clsVisitHoverButton clsHoverButtonInactive"",""clsVisitHoverButton clsHoverButtonSelected"");" & vbCrLf
s = s & " }" & vbCrLf
s = s & " function fnLoadVisitBorder(sSubjectLabel,sVisitList,sSelectedVisitTaskId)" & vbCrLf
s = s & " {" & vbCrLf
s = s & "         //call this to load menu" & vbCrLf
s = s & "         var sHtml;" & vbCrLf
s = s & "         var aItem;" & vbCrLf
s = s & "         var aList=sVisitList.split(sDel1);" & vbCrLf
s = s & "                 var osHTML=new Array();" & vbCrLf
s = s & "                 " & vbCrLf
s = s & "         osHTML.push(""<table width='100%' border='0' cellpadding='0' cellspacing='0'>"");" & vbCrLf
s = s & "         //cell for label/text menu options table" & vbCrLf
s = s & "         osHTML.push(""<tr height='20'>"");" & vbCrLf
s = s & "         osHTML.push(""<td colspan='2'>"");" & vbCrLf
s = s & "         osHTML.push(""<table width='100%' height='100%' cellpadding='0' cellspacing='0' border='0'>"");" & vbCrLf
s = s & "         osHTML.push(""<tr><td align='left'><table><tr><td><div class='clsScheduleEformBorder clsScheduleHeadingText'>""+sSubjectLabel+""</div></td></tr></table></td>"");" & vbCrLf
s = s & "         osHTML.push(""<td align='center' class='clsScheduleMenuLinkText'>"");" & vbCrLf
s = s & "         // ATN 23/1/2003 - Print option removed from here." & vbCrLf
s = s & "         // osHTML.push(""<a href='javascript:fnPrint();'>Print</a>&nbsp;&nbsp;&nbsp;"";" & vbCrLf
s = s & "         //osHTML.push(""<a href='javascript:fnClose();'>Close</a>"");" & vbCrLf
s = s & "         osHTML.push(""</td></tr>"");" & vbCrLf
s = s & "         osHTML.push(""</table>"");" & vbCrLf
s = s & "         osHTML.push(""</td></tr>"");" & vbCrLf
s = s & "         //spacer row" & vbCrLf
s = s & "         osHTML.push(""<tr height='10'><td colspan='2'></td></tr>"");" & vbCrLf
s = s & "         //cell for menu icons table" & vbCrLf
s = s & "         osHTML.push(""<tr><td width='1%' align='center' valign='top'>"");" & vbCrLf
s = s & "         osHTML.push(""<table border='0' cellpadding='1' cellspacing='0'><tr>"");" & vbCrLf
s = s & "         osHTML.push(""<td width='5'>&nbsp;</td>"");" & vbCrLf
s = s & "         osHTML.push(""<td><a href='javascript:fnSave(\""m3\"");' onmouseout=\""button_off('ico_return'); return true\"" onmouseover=\""button_on('ico_return'); return true\""><img alt='Save and return' border='0' src='../img/ico_return.gif' name='ico_return'></a></td>"");" & vbCrLf
s = s & "         osHTML.push(""<td><a href='javascript:fnClose();' onmouseout=\""button_off('ico_cancel'); return true\"" onmouseover=\""button_on('ico_cancel'); return true\""><img alt='Cancel and return' border='0' src='../img/ico_cancel.gif' name='ico_cancel'></a></td>"");" & vbCrLf
s = s & "         osHTML.push(""<td><a href='javascript:fnPrint();' onmouseout=\""button_off('ico_print'); return true\"" onmouseover=\""button_on('ico_print'); return true\""><img alt='Print eForm' border='0' src='../img/ico_print.gif' name='ico_print'></a></td>"");" & vbCrLf
s = s & "         osHTML.push(""<td><a href='javascript:fnSave(\""m1\"");' onmouseout=\""button_off('ico_back'); return true\"" onmouseover=\""button_on('ico_back'); return true\""><img alt='Save and move to previous eForm' border='0' src='../img/ico_back.gif' name='ico_back'></a></td>"");" & vbCrLf
s = s & "         osHTML.push(""<td><a href='javascript:fnSave(\""m2\"");' onmouseout=\""button_off('ico_forward'); return true\"" onmouseover=\""button_on('ico_forward'); return true\""><img alt='Save and move to next eForm' border='0' src='../img/ico_forward.gif' name='ico_forward'></a></td>"");" & vbCrLf
s = s & "         osHTML.push(""<td width='1'>&nbsp;</td>"");" & vbCrLf
s = s & "         osHTML.push(""</tr></table>"");" & vbCrLf
s = s & "         osHTML.push(""</td>"");" & vbCrLf
s = s & "         //cell for visit table" & vbCrLf
s = s & "         osHTML.push(""<td><div id='divScroll' style='width:""+(document.all.divVisits.offsetWidth-180)+"";overflow:auto'>"");" & vbCrLf
s = s & "         osHTML.push(""<table width='100%' height='100%' cellpadding='0' cellspacing='0'>"");" & vbCrLf
s = s & "         //blue line" & vbCrLf
s = s & "         osHTML.push(""<tr height='2'><td bgcolor='blue' colspan='""+aList.length+""'></td></tr>"");" & vbCrLf
s = s & "         //down vs" & vbCrLf
s = s & "         osHTML.push(""<tr height='3'>"");" & vbCrLf
s = s & "         for (var nCol=0;nCol<aList.length;nCol++)" & vbCrLf
s = s & "         {" & vbCrLf
s = s & "                 osHTML.push(""<td valign='top' align='center'><img src='../img/v.gif'></td></td>"");" & vbCrLf
s = s & "         }" & vbCrLf
s = s & "         osHTML.push(""</tr>"");" & vbCrLf
s = s & "         //visit names" & vbCrLf
s = s & "         osHTML.push(""<tr height='20' class='clsScheduleVisitText'>"");" & vbCrLf
s = s & "         for (nCol=0;nCol<aList.length;nCol++)" & vbCrLf
s = s & "         {" & vbCrLf
s = s & "                 aItem=aList[nCol].split(sDel2);" & vbCrLf
s = s & "                 osHTML.push(""<td valign='top' align='center'>"");" & vbCrLf
s = s & "                 sHTML = (aItem[1]==sSelectedVisitTaskId)? ""<div title='""+aItem[2]+""' id='divVisit' class='clsVisitHoverButton clsHoverButtonSelected'>""+aItem[0]+""</div>"":""<div title='""+aItem[2]+""' onmouseout='javascript:fnSetButtonUnHover(this);' onclick='javascript:fnSave(\""v""+aItem[1]+""\"");' onmouseover='javascript:fnSetButtonHover(this);' id='divVisit' class='clsVisitHoverButton clsHoverButtonInactive'>""+aItem[0]+""</div>"";" & vbCrLf
s = s & "                 osHTML.push(sHTML);" & vbCrLf
s = s & "                 osHTML.push(""</td>"");" & vbCrLf
s = s & "         }" & vbCrLf
s = s & "         osHTML.push(""</tr>"");" & vbCrLf
s = s & "         osHTML.push(""</div></td></tr>"");" & vbCrLf
s = s & "         //spacer row" & vbCrLf
s = s & "         //osHTML.push(""<tr height='10'><td colspan='2'></td></tr>"");" & vbCrLf
s = s & "         osHTML.push(""</table>"");" & vbCrLf
s = s & "         document.all.divVisits.innerHTML=osHTML.join('');" & vbCrLf
s = s & "" & vbCrLf
s = s & "         fnPageLoaded();" & vbCrLf
s = s & "//<!--r-->               " & vbCrLf
s = s & "         //set the top frame to the height of the visit table" & vbCrLf
s = s & "//<!--r-->" & vbCrLf
s = s & " }" & vbCrLf
s = s & " function fnDisable()" & vbCrLf
s = s & " {" & vbCrLf
s = s & "         document.all.divVisits.innerHTML="""";" & vbCrLf
s = s & " }" & vbCrLf
s = s & "</script>" & vbCrLf
s = s & "</head>" & vbCrLf
s = s & "<body class='clsScheduleBorder'>" & vbCrLf
s = s & "<div id=""divVisits"" ></div>" & vbCrLf
s = s & "</body>" & vbCrLf
s = s & "</html>" & vbCrLf
s = s & " "
CompiledeFormTopHTML = s
End Function
'-----------------------------------------------------------------------------
Public Function CompiledScheduleJS() As String
'-----------------------------------------------------------------------------
Dim s As String
s = ""
s = s & "var oU;" & vbCrLf
s = s & "var oS;" & vbCrLf
s = s & "var sDel1=""`"";" & vbCrLf
s = s & "var sDel2=""|"";" & vbCrLf
s = s & "var gsETitle="""";" & vbCrLf
s = s & "var gsVTitle="""";" & vbCrLf
s = s & "" & vbCrLf
s = s & "function fnExpand(sHTML)" & vbCrLf
s = s & "{" & vbCrLf
s = s & " var sDELIMITER = '\\|';" & vbCrLf
s = s & " var sIMAGE_START = '!F';" & vbCrLf
s = s & " var sIMAGE_PLANNED_SDV_START = ""!SP"";" & vbCrLf
s = s & " var sIMAGE_QUERIED_SDV_START = ""!SQ"";" & vbCrLf
s = s & " var sIMAGE_DONE_SDV_START = ""!SD"";" & vbCrLf
s = s & " var sIMAGE_END = ""F->"";" & vbCrLf
s = s & " var sTABLE_START = ""!T"";" & vbCrLf
s = s & " var sTABLE_END = ""T->"";" & vbCrLf
s = s & " var sCELL_START = ""<!--C"";" & vbCrLf
s = s & " var sCELL_END = ""-->"";" & vbCrLf
s = s & " var sTERM = ""([^!]*)"";" & vbCrLf
s = s & " var sEFORM_HEADER_START = ""<!--E"";" & vbCrLf
s = s & " var sBLANK_EFORM_HEADER = ""<!--B-->"";" & vbCrLf
s = s & " var sEFORM_HEADER_END = ""-->"";" & vbCrLf
s = s & " var sVISIT_START = ""<!--V"";" & vbCrLf
s = s & " var sVISIT_END = ""-->"";" & vbCrLf
s = s & " var sVISIT_TITLE_START = ""<!--A"";" & vbCrLf
s = s & " var sVISIT_TITLE_END = ""-->"";" & vbCrLf
s = s & " var sV = ""<!--D-->"";" & vbCrLf
s = s & " " & vbCrLf
s = s & " sHTML = sHTML.replace(new RegExp(sV,'g'),'<td valign=top align=center>');" & vbCrLf
s = s & " " & vbCrLf
s = s & " sHTML = sHTML.replace(new RegExp(sVISIT_TITLE_START + sTERM + sDELIMITER + sTERM + sDELIMITER + sTERM + sVISIT_TITLE_END,'g'),'<a onMouseup=\'javascript:$1\'><td style=""cursor:default"" title=""$2"">&nbsp;$3&nbsp;</td></a>');" & vbCrLf
s = s & " sHTML = sHTML.replace(new RegExp(sVISIT_START + sTERM + sDELIMITER + sTERM + sDELIMITER + sTERM + sVISIT_END,'g'),'<table><tr><td align=center class=""clsScheduleBorder clsScheduleVisitDateText"" height=20 title=""Please open a form to edit the visit date"">$1</td></tr><tr><a onMouseup=\'javascript:$2\'><td align=center style=""cursor:default"">$3</td></a></tr></table>');" & vbCrLf
s = s & " " & vbCrLf
s = s & " sHTML = sHTML.replace(new RegExp(sEFORM_HEADER_START + sTERM + sDELIMITER + sTERM + sEFORM_HEADER_END,'g'),'<tr valign=top align=center><td class=clsScheduleBorder title=""$1""><div class=""clsScheduleEformBorder clsScheduleEformText"">$2</div></td>');" & vbCrLf
s = s & " sHTML = sHTML.replace(new RegExp(sBLANK_EFORM_HEADER,'g'),'<tr valign=top align=center><td class=clsScheduleBorder></td>');" & vbCrLf
s = s & " " & vbCrLf
s = s & " sHTML = sHTML.replace(new RegExp(sIMAGE_PLANNED_SDV_START + sTERM + sDELIMITER + sTERM + sIMAGE_END,'g'),'<table cellpadding=0 cellspacing=0><tr><td><img border=0 style=""cursor:hand"" src=""../img/$1.gif"" alt=""$2""></td></tr><tr><td><img border=0 src=""../img/icof_sdv_plan.gif""></td></tr></table>');" & vbCrLf
s = s & " sHTML = sHTML.replace(new RegExp(sIMAGE_QUERIED_SDV_START + sTERM + sDELIMITER + sTERM + sIMAGE_END,'g'),'<table cellpadding=0 cellspacing=0><tr><td><img border=0 style=""cursor:hand"" src=""../img/$1.gif"" alt=""$2""></td></tr><tr><td><img border=0 src=""../img/icof_sdv_query.gif""></td></tr></table>');" & vbCrLf
s = s & " sHTML = sHTML.replace(new RegExp(sIMAGE_DONE_SDV_START + sTERM + sDELIMITER + sTERM + sIMAGE_END,'g'),'<table cellpadding=0 cellspacing=0><tr><td><img border=0 style=""cursor:hand"" src=""../img/$1.gif"" alt=""$2""></td></tr><tr><td><img border=0 src=""../img/icof_sdv_done.gif""></td></tr></table>');" & vbCrLf
s = s & " " & vbCrLf
s = s & " sHTML = sHTML.replace(new RegExp(sIMAGE_START + sTERM + sDELIMITER + sTERM + sIMAGE_END,'g'),'<img border=0 style=""cursor:hand"" src=""../img/$1.gif"" alt=""$2"">');" & vbCrLf
s = s & " " & vbCrLf
s = s & " sHTML=sHTML.replace(new RegExp(sTABLE_START + sTERM + sDELIMITER + sTERM + sDELIMITER + sTERM + sDELIMITER + sTERM + sTABLE_END,'g'),'<table><tr><a onMouseup=\'javascript:$1\'><td>$2</td></a></tr></table>$3<br>$4<br>');" & vbCrLf
s = s & "" & vbCrLf
s = s & " sHTML = sHTML.replace(new RegExp(sCELL_START + sTERM + sDELIMITER + sTERM + sCELL_END,'g'),'<td align=center valign=top class=clsScheduleEformLabelText bgcolor=$1>$2</td>');" & vbCrLf
s = s & " " & vbCrLf
s = s & " return sHTML;   " & vbCrLf
s = s & "}" & vbCrLf
s = s & "" & vbCrLf
s = s & "var scrollLeft=0, scrollTop=0;" & vbCrLf
s = s & "" & vbCrLf
s = s & "function ShowHeaders(){" & vbCrLf
s = s & " if(scrollLeft==document.body.scrollLeft&&scrollTop==document.body.scrollTop){" & vbCrLf
s = s & "         document.all.top.style.visibility='visible';" & vbCrLf
s = s & "         rowhead.style.visibility='visible';" & vbCrLf
s = s & "         colhead.style.visibility='visible';" & vbCrLf
s = s & "         document.all.blank.style.visibility='visible';" & vbCrLf
s = s & " }" & vbCrLf
s = s & " scrollLeft=document.body.scrollLeft;" & vbCrLf
s = s & " scrollTop=document.body.scrollTop;" & vbCrLf
s = s & "}" & vbCrLf
s = s & "" & vbCrLf
s = s & "function SizeHeaders(){" & vbCrLf
s = s & "var i, j, nHeightCum=0;" & vbCrLf
s = s & "var oMain=document.all.main;" & vbCrLf
s = s & "var nMainLength=oMain.rows.length;" & vbCrLf
s = s & "var oCol=document.all.colhead;" & vbCrLf
s = s & "var oRow=document.all.rowhead;" & vbCrLf
s = s & "var nLength,oStyle,oCell,nTop,nHeight,osHTML;" & vbCrLf
s = s & "" & vbCrLf
s = s & " for(i=0;i<nMainLength;i++)" & vbCrLf
s = s & " {" & vbCrLf
s = s & "         if(oMain.rows(i).id=='head')" & vbCrLf
s = s & "         {" & vbCrLf
s = s & "                 nLength=oMain.rows(i).cells.length;" & vbCrLf
s = s & "                 nTop=oCol.rows(i).cells(0).style.offsetTop;" & vbCrLf
s = s & "                 nHeight=oCol.rows(i).cells(0).style.clientHeight;" & vbCrLf
s = s & "                 " & vbCrLf
s = s & "                 for(j=0;j<nLength;j++)" & vbCrLf
s = s & "                 {" & vbCrLf
s = s & "                         oStyle=oCol.rows(i).cells(j).style" & vbCrLf
s = s & "                         oCell=oMain.rows(i).cells(j)" & vbCrLf
s = s & "                 " & vbCrLf
s = s & "                         oStyle.position='absolute';" & vbCrLf
s = s & "                         oStyle.pixelLeft=oCell.offsetLeft;" & vbCrLf
s = s & "                         oStyle.pixelTop=oCell.offsetTop;" & vbCrLf
s = s & "                         oStyle.pixelHeight=oCell.clientHeight;" & vbCrLf
s = s & "                         oStyle.pixelWidth=oCell.clientWidth;" & vbCrLf
s = s & "                 }" & vbCrLf
s = s & "                 nHeightCum+=oCol.rows(i).cells(0).style.pixelHeight;" & vbCrLf
s = s & "         }" & vbCrLf
s = s & "         oStyle=oRow.rows(i).cells(0).style;" & vbCrLf
s = s & "         oCell=oMain.rows(i).cells(0);" & vbCrLf
s = s & "         " & vbCrLf
s = s & "         oStyle.position='absolute';" & vbCrLf
s = s & "         oStyle.pixelLeft=oCell.offsetLeft;" & vbCrLf
s = s & "         oStyle.pixelTop=oCell.offsetTop;" & vbCrLf
s = s & "         oStyle.pixelHeight=oCell.clientHeight;" & vbCrLf
s = s & "         oStyle.pixelWidth=oCell.clientWidth;" & vbCrLf
s = s & " }" & vbCrLf
s = s & " document.all.blank.style.pixelWidth=document.all.rowhead.rows(0).cells(0).style.pixelWidth;" & vbCrLf
s = s & " document.all.blank.style.pixelHeight=nHeightCum;" & vbCrLf
s = s & " PositionHeaders();      " & vbCrLf
s = s & "}" & vbCrLf
s = s & "" & vbCrLf
s = s & "function PositionHeaders(){" & vbCrLf
s = s & " rowhead.style.pixelLeft=document.body.scrollLeft + document.all.main.offsetLeft;" & vbCrLf
s = s & " colhead.style.pixelTop = document.body.scrollTop + document.all.main.offsetTop;" & vbCrLf
s = s & " document.all.top.style.pixelLeft=document.all.rowhead.style.pixelLeft;" & vbCrLf
s = s & " document.all.top.style.pixelTop=document.body.scrollTop;" & vbCrLf
s = s & " document.all.blank.style.pixelLeft=document.all.rowhead.style.pixelLeft;" & vbCrLf
s = s & " document.all.blank.style.pixelTop=document.all.colhead.style.pixelTop;" & vbCrLf
s = s & "" & vbCrLf
s = s & " document.all.top.style.visibility='hidden';" & vbCrLf
s = s & " rowhead.style.visibility='hidden';" & vbCrLf
s = s & " colhead.style.visibility='hidden';" & vbCrLf
s = s & " document.all.blank.style.visibility='hidden';" & vbCrLf
s = s & "}" & vbCrLf
s = s & "" & vbCrLf
s = s & "function DrawHeaders(){" & vbCrLf
s = s & "var i,j,oRow;" & vbCrLf
s = s & "var osCol=new Array();" & vbCrLf
s = s & "var osRow=new Array();" & vbCrLf
s = s & "var oMain=document.all.main;" & vbCrLf
s = s & "var nMainLength=oMain.rows.length;" & vbCrLf
s = s & "var sStart=/<[TR][^>]*>/;" & vbCrLf
s = s & " " & vbCrLf
s = s & " osRow.push(document.all.rowhead.outerHTML.replace(/<\/table>/i,''));" & vbCrLf
s = s & " osCol.push(document.all.colhead.outerHTML.replace(/<\/table>/i,''));" & vbCrLf
s = s & " " & vbCrLf
s = s & " osCol.push(oMain.rows(0).outerHTML);" & vbCrLf
s = s & " osCol.push(oMain.rows(1).outerHTML);" & vbCrLf
s = s & " osCol.push(oMain.rows(2).outerHTML);" & vbCrLf
s = s & " osCol.push(oMain.rows(3).outerHTML);" & vbCrLf
s = s & " " & vbCrLf
s = s & " for(i=0;i<nMainLength;i++)" & vbCrLf
s = s & " {" & vbCrLf
s = s & "         oRow=oMain.rows(i);                     " & vbCrLf
s = s & "         osRow.push(sStart.exec(oRow.outerHTML));" & vbCrLf
s = s & "         osRow.push(oRow.cells(0).outerHTML);" & vbCrLf
s = s & "         osRow.push('</tr>');" & vbCrLf
s = s & " }" & vbCrLf
s = s & " " & vbCrLf
s = s & " osCol.push('</table>');" & vbCrLf
s = s & " osRow.push('</table>');" & vbCrLf
s = s & " " & vbCrLf
s = s & " colhead.outerHTML=osCol.join('');" & vbCrLf
s = s & " colhead.style.pixelWidth=oMain.clientWidth;" & vbCrLf
s = s & " " & vbCrLf
s = s & " rowhead.outerHTML=osRow.join('');" & vbCrLf
s = s & " rowhead.style.pixelWidth=oMain.rows(0).cells(0).clientWidth;" & vbCrLf
s = s & " rowhead.style.pixelHeight=oMain.clientHeight;" & vbCrLf
s = s & " rowhead.style.pixelTop=document.all.top.clientHeight;" & vbCrLf
s = s & " " & vbCrLf
s = s & " document.all.top.style.position='absolute';" & vbCrLf
s = s & " document.all.blank.style.position='absolute';" & vbCrLf
s = s & " document.all.top.style.zIndex=101;" & vbCrLf
s = s & "" & vbCrLf
s = s & " SizeHeaders();" & vbCrLf
s = s & " ShowHeaders();" & vbCrLf
s = s & " window.setInterval('ShowHeaders();',200);" & vbCrLf
s = s & "}" & vbCrLf
s = s & "" & vbCrLf
s = s & "function fnClose()" & vbCrLf
s = s & "{" & vbCrLf
s = s & " window.parent.fnHomeUrl();" & vbCrLf
s = s & "}" & vbCrLf
s = s & "function fnInitUser(bViewData,bChangeData,bCreateSDV,bLockData," & vbCrLf
s = s & "                                 bFreezeData,bUnFreezeData)" & vbCrLf
s = s & "{" & vbCrLf
s = s & " oU=new Object();" & vbCrLf
s = s & " oU.bViewData=bViewData;" & vbCrLf
s = s & " oU.bChangeData=bChangeData;" & vbCrLf
s = s & " oU.bCreateSDV=bCreateSDV;" & vbCrLf
s = s & " oU.bLockData=bLockData;" & vbCrLf
s = s & " oU.bFreezeData=bFreezeData;" & vbCrLf
s = s & " oU.bUnFreezeData=bUnFreezeData;" & vbCrLf
s = s & "}" & vbCrLf
s = s & "function fnInitSubject(sStudy,sSite,sSubject,sLabel)" & vbCrLf
s = s & "{" & vbCrLf
s = s & " oS=new Object();" & vbCrLf
s = s & " oS.sStudy=sStudy;" & vbCrLf
s = s & " oS.sSite=sSite;" & vbCrLf
s = s & " oS.sSubject=sSubject;" & vbCrLf
s = s & " oS.Label=sLabel;" & vbCrLf
s = s & "}" & vbCrLf
s = s & "" & vbCrLf
s = s & "/*<!--r-->*/" & vbCrLf
s = s & "" & vbCrLf
s = s & "window.onresize=SizeHeaders;" & vbCrLf
s = s & "" & vbCrLf
s = s & "function fnS(nBtn,nStatus,bLocked,bFrozen,bCanUnFreeze)" & vbCrLf
s = s & "{" & vbCrLf
s = s & " var sHtml="""";" & vbCrLf
s = s & " sHtml+=""<table width='130'>"";" & vbCrLf
s = s & " var bUnLocked=((!bLocked)&&(!bFrozen));" & vbCrLf
s = s & " var nLFScope=1;" & vbCrLf
s = s & " var nLFAction=0;" & vbCrLf
s = s & "    var bSep=false;" & vbCrLf
s = s & "    " & vbCrLf
s = s & "    if (nBtn==1) return;" & vbCrLf
s = s & "    " & vbCrLf
s = s & " if (oU.bLockData)" & vbCrLf
s = s & " {" & vbCrLf
s = s & "         if(bUnLocked)" & vbCrLf
s = s & "         {" & vbCrLf
s = s & "                 //Lock" & vbCrLf
s = s & "                 var sCompletid=oS.sStudy+sDel1+oS.sSite+sDel1+oS.sSubject+sDel1+sDel1+sDel1+sDel1;" & vbCrLf
s = s & "                 nLFAction=1;" & vbCrLf
s = s & "                 sCompletid+=sDel1+nLFScope+sDel1+nLFAction;" & vbCrLf
s = s & "                 sHtml+=""<tr height='15'><td class='clsPopMenuLinkText'>"";" & vbCrLf
s = s & "                 sHtml+=""<a href='javascript:fnPopMenuClick(\""""+sCompletid+""\"",5);'>Lock</a>"";" & vbCrLf
s = s & "                 sHtml+=""</td></tr>"";" & vbCrLf
s = s & "         }" & vbCrLf
s = s & "         else" & vbCrLf
s = s & "         {" & vbCrLf
s = s & "                 sHtml+=""<tr height='15'><td class='clsPopMenuLinkText'>Lock</td></tr>"";" & vbCrLf
s = s & "         }" & vbCrLf
s = s & "         bSep=true;" & vbCrLf
s = s & " }" & vbCrLf
s = s & " if (oU.bLockData)" & vbCrLf
s = s & " {" & vbCrLf
s = s & "         if(bLocked)" & vbCrLf
s = s & "         {" & vbCrLf
s = s & "                 //Unlock" & vbCrLf
s = s & "                 var sCompletid=oS.sStudy+sDel1+oS.sSite+sDel1+oS.sSubject+sDel1+sDel1+sDel1+sDel1;" & vbCrLf
s = s & "                 nLFAction=0;" & vbCrLf
s = s & "                 sCompletid+=sDel1+nLFScope+sDel1+nLFAction;" & vbCrLf
s = s & "                 sHtml+=""<tr height='15'><td class='clsPopMenuLinkText'>"";" & vbCrLf
s = s & "                 sHtml+=""<a href='javascript:fnPopMenuClick(\""""+sCompletid+""\"",5);'>Unlock</a>"";" & vbCrLf
s = s & "                 sHtml+=""</td></tr>"";" & vbCrLf
s = s & "         }" & vbCrLf
s = s & "         else" & vbCrLf
s = s & "         {" & vbCrLf
s = s & "                 sHtml+=""<tr height='15'><td class='clsPopMenuLinkText'>Unlock</td></tr>"";" & vbCrLf
s = s & "         }" & vbCrLf
s = s & "         bSep=true;" & vbCrLf
s = s & " }" & vbCrLf
s = s & " if (oU.bFreezeData)" & vbCrLf
s = s & " {" & vbCrLf
s = s & "         if(!bFrozen)" & vbCrLf
s = s & "         {" & vbCrLf
s = s & "                 //Freeze" & vbCrLf
s = s & "                 var sCompletid=oS.sStudy+sDel1+oS.sSite+sDel1+oS.sSubject+sDel1+sDel1+sDel1+sDel1;" & vbCrLf
s = s & "                 nLFAction=2;" & vbCrLf
s = s & "                 sCompletid+=sDel1+nLFScope+sDel1+nLFAction;" & vbCrLf
s = s & "                 sHtml+=""<tr height='15'><td class='clsPopMenuLinkText'>"";" & vbCrLf
s = s & "                 sHtml+=""<a href='javascript:fnPopMenuClick(\""""+sCompletid+""\"",5);'>Freeze</a>"";" & vbCrLf
s = s & "                 sHtml+=""</td></tr>"";" & vbCrLf
s = s & "         }" & vbCrLf
s = s & "         else" & vbCrLf
s = s & "         {" & vbCrLf
s = s & "                 sHtml+=""<tr height='15'><td class='clsPopMenuLinkText'>Freeze</td></tr>"";" & vbCrLf
s = s & "         }" & vbCrLf
s = s & "         bSep=true;" & vbCrLf
s = s & " }" & vbCrLf
s = s & " if (oU.bUnFreezeData)" & vbCrLf
s = s & " {" & vbCrLf
s = s & "         if(bCanUnFreeze)" & vbCrLf
s = s & "         {" & vbCrLf
s = s & "                 //UnFreeze" & vbCrLf
s = s & "                 var sCompletid=oS.sStudy+sDel1+oS.sSite+sDel1+oS.sSubject+sDel1+sDel1+sDel1+sDel1;" & vbCrLf
s = s & "                 nLFAction=3;" & vbCrLf
s = s & "                 sCompletid+=sDel1+nLFScope+sDel1+nLFAction;" & vbCrLf
s = s & "                 sHtml+=""<tr height='15'><td class='clsPopMenuLinkText'>"";" & vbCrLf
s = s & "                 sHtml+=""<a href='javascript:fnPopMenuClick(\""""+sCompletid+""\"",5);'>UnFreeze</a>"";" & vbCrLf
s = s & "                 sHtml+=""</td></tr>"";" & vbCrLf
s = s & "         }" & vbCrLf
s = s & "         else" & vbCrLf
s = s & "         {" & vbCrLf
s = s & "                 sHtml+=""<tr height='15'><td class='clsPopMenuLinkText'>UnFreeze</td></tr>"";" & vbCrLf
s = s & "         }" & vbCrLf
s = s & "         bSep=true;" & vbCrLf
s = s & " }" & vbCrLf
s = s & " if(bSep)" & vbCrLf
s = s & " {       " & vbCrLf
s = s & "         sHtml+=""<tr height='1'><td align=left width='98%' bgcolor='#C0C0C0'></td></tr>"";" & vbCrLf
s = s & " }" & vbCrLf
s = s & " if (oU.bChangeData)" & vbCrLf
s = s & " {" & vbCrLf
s = s & "         var sCompletid=oS.sStudy+sDel1+oS.sSite+sDel1+oS.sSubject+sDel1+sDel1+sDel1+sDel1+sDel1+""s"";" & vbCrLf
s = s & "         sHtml+=""<tr height='15'><td class='clsPopMenuLinkText'>"";" & vbCrLf
s = s & "         sHtml+=(((nStatus==""10"")||(nStatus==""-10""))&&(!oS.bReadOnly)&&(bUnLocked))? ""<a href='javascript:fnPopMenuClick(\""""+sCompletid+""\"",0);'>Unobtainable</a>"":""Unobtainable"";" & vbCrLf
s = s & "         sHtml+=""</td></tr>"";" & vbCrLf
s = s & "                 " & vbCrLf
s = s & "         sHtml+=""<tr height='15'><td class='clsPopMenuLinkText'>"";" & vbCrLf
s = s & "         sHtml+=((nStatus==""-5"")&&(!oS.bReadOnly)&&(bUnLocked))? ""<a href='javascript:fnPopMenuClick(\""""+sCompletid+""\"",1);'>Missing</a>"":""Missing"";" & vbCrLf
s = s & "         sHtml+=""</td></tr>"";" & vbCrLf
s = s & "         sHtml+=""<tr height='1'><td align=left width='98%' bgcolor='#C0C0C0'></td></tr>"";" & vbCrLf
s = s & " }" & vbCrLf
s = s & "    if (oU.bCreateSDV)" & vbCrLf
s = s & " {" & vbCrLf
s = s & "         var sCompletid=oS.sStudy+sDel1+oS.sSite+sDel1+oS.sSubject+sDel1+sDel1+sDel1+sDel1;" & vbCrLf
s = s & "         sHtml+=""<tr height='15'><td class='clsPopMenuLinkText'>"";" & vbCrLf
s = s & "         sHtml+=""<a href='javascript:fnPopMenuClick(\""""+sCompletid+""\"",4);'>Subject SDV...</a>"";" & vbCrLf
s = s & "         sHtml+=""</td></tr>"";" & vbCrLf
s = s & "    }" & vbCrLf
s = s & " sHtml+=""</table>"";" & vbCrLf
s = s & " document.all['divPopMenu'].innerHTML=sHtml;" & vbCrLf
s = s & " fnPopMenuShow(document.all['divPopMenu'])" & vbCrLf
s = s & "}" & vbCrLf
s = s & "" & vbCrLf
s = s & "function fnV(nBtn,sViId,sViCycle,sViTitle,nStatus,bLocked,bFrozen,bCanUnFreeze)" & vbCrLf
s = s & "{" & vbCrLf
s = s & " gsVTitle=sViTitle;" & vbCrLf
s = s & " var bUnLocked=((!bLocked)&&(!bFrozen));" & vbCrLf
s = s & " var nLFScope=2;" & vbCrLf
s = s & " var nLFAction=0;" & vbCrLf
s = s & " var sHtml="""";" & vbCrLf
s = s & " sHtml+=""<table width='130'>"";" & vbCrLf
s = s & "    var bSep=false;" & vbCrLf
s = s & "    " & vbCrLf
s = s & "    if (nBtn==1) return;" & vbCrLf
s = s & "    " & vbCrLf
s = s & " if (oU.bLockData)" & vbCrLf
s = s & " {" & vbCrLf
s = s & "         if(bUnLocked)" & vbCrLf
s = s & "         {" & vbCrLf
s = s & "                 //Lock" & vbCrLf
s = s & "                 var sCompletid=oS.sStudy+sDel1+oS.sSite+sDel1+oS.sSubject+sDel1+sViId+sDel1+sViCycle+sDel1+sDel1;" & vbCrLf
s = s & "                 nLFAction=1;" & vbCrLf
s = s & "                 sCompletid+=sDel1+nLFScope+sDel1+nLFAction;" & vbCrLf
s = s & "                 sHtml+=""<tr height='15'><td class='clsPopMenuLinkText'>"";" & vbCrLf
s = s & "                 sHtml+=""<a href='javascript:fnPopMenuClick(\""""+sCompletid+""\"",5);'>Lock</a>"";" & vbCrLf
s = s & "                 sHtml+=""</td></tr>"";" & vbCrLf
s = s & "         }" & vbCrLf
s = s & "         else" & vbCrLf
s = s & "         {" & vbCrLf
s = s & "                 sHtml+=""<tr height='15'><td class='clsPopMenuLinkText'>Lock</td></tr>"";" & vbCrLf
s = s & "         }" & vbCrLf
s = s & "         bSep=true;" & vbCrLf
s = s & " }" & vbCrLf
s = s & " if (oU.bLockData)" & vbCrLf
s = s & " {" & vbCrLf
s = s & "         if(bLocked)" & vbCrLf
s = s & "         {" & vbCrLf
s = s & "                 //Unlock" & vbCrLf
s = s & "                 var sCompletid=oS.sStudy+sDel1+oS.sSite+sDel1+oS.sSubject+sDel1+sViId+sDel1+sViCycle+sDel1+sDel1;" & vbCrLf
s = s & "                 nLFAction=0;" & vbCrLf
s = s & "                 sCompletid+=sDel1+nLFScope+sDel1+nLFAction;" & vbCrLf
s = s & "                 sHtml+=""<tr height='15'><td class='clsPopMenuLinkText'>"";" & vbCrLf
s = s & "                 sHtml+=""<a href='javascript:fnPopMenuClick(\""""+sCompletid+""\"",5);'>Unlock</a>"";" & vbCrLf
s = s & "                 sHtml+=""</td></tr>"";" & vbCrLf
s = s & "         }" & vbCrLf
s = s & "         else" & vbCrLf
s = s & "         {" & vbCrLf
s = s & "                 sHtml+=""<tr height='15'><td class='clsPopMenuLinkText'>Unlock</td></tr>"";" & vbCrLf
s = s & "         }" & vbCrLf
s = s & "         bSep=true;" & vbCrLf
s = s & " }" & vbCrLf
s = s & " if (oU.bFreezeData)" & vbCrLf
s = s & " {" & vbCrLf
s = s & "         if(!bFrozen)" & vbCrLf
s = s & "         {" & vbCrLf
s = s & "                 //Freeze" & vbCrLf
s = s & "                 var sCompletid=oS.sStudy+sDel1+oS.sSite+sDel1+oS.sSubject+sDel1+sViId+sDel1+sViCycle+sDel1+sDel1;" & vbCrLf
s = s & "                 nLFAction=2;" & vbCrLf
s = s & "                 sCompletid+=sDel1+nLFScope+sDel1+nLFAction;" & vbCrLf
s = s & "                 sHtml+=""<tr height='15'><td class='clsPopMenuLinkText'>"";" & vbCrLf
s = s & "                 sHtml+=""<a href='javascript:fnPopMenuClick(\""""+sCompletid+""\"",5);'>Freeze</a>"";" & vbCrLf
s = s & "                 sHtml+=""</td></tr>"";" & vbCrLf
s = s & "         }" & vbCrLf
s = s & "         else" & vbCrLf
s = s & "         {" & vbCrLf
s = s & "                 sHtml+=""<tr height='15'><td class='clsPopMenuLinkText'>Freeze</td></tr>"";" & vbCrLf
s = s & "         }" & vbCrLf
s = s & "         bSep=true;" & vbCrLf
s = s & " }" & vbCrLf
s = s & " if (oU.bUnFreezeData)" & vbCrLf
s = s & " {" & vbCrLf
s = s & "         if(bCanUnFreeze)" & vbCrLf
s = s & "         {" & vbCrLf
s = s & "                 //UnFreeze" & vbCrLf
s = s & "                 var sCompletid=oS.sStudy+sDel1+oS.sSite+sDel1+oS.sSubject+sDel1+sViId+sDel1+sViCycle+sDel1+sDel1;" & vbCrLf
s = s & "                 nLFAction=3;" & vbCrLf
s = s & "                 sCompletid+=sDel1+nLFScope+sDel1+nLFAction;" & vbCrLf
s = s & "                 sHtml+=""<tr height='15'><td class='clsPopMenuLinkText'>"";" & vbCrLf
s = s & "                 sHtml+=""<a href='javascript:fnPopMenuClick(\""""+sCompletid+""\"",5);'>UnFreeze</a>"";" & vbCrLf
s = s & "                 sHtml+=""</td></tr>"";" & vbCrLf
s = s & "         }" & vbCrLf
s = s & "         else" & vbCrLf
s = s & "         {" & vbCrLf
s = s & "                 sHtml+=""<tr height='15'><td class='clsPopMenuLinkText'>UnFreeze</td></tr>"";" & vbCrLf
s = s & "         }" & vbCrLf
s = s & "         bSep=true;" & vbCrLf
s = s & " }" & vbCrLf
s = s & " if(bSep)" & vbCrLf
s = s & " {" & vbCrLf
s = s & "         sHtml+=""<tr height='1'><td align=left width='98%' bgcolor='#C0C0C0'></td></tr>"";" & vbCrLf
s = s & " }" & vbCrLf
s = s & " if (oU.bChangeData)" & vbCrLf
s = s & " {" & vbCrLf
s = s & "         var sCompletid=oS.sStudy+sDel1+oS.sSite+sDel1+oS.sSubject+sDel1+sViId+sDel1+sViCycle+sDel1+sDel1+sDel1+""v"";" & vbCrLf
s = s & "         sHtml+=""<tr height='15'><td class='clsPopMenuLinkText'>"";" & vbCrLf
s = s & "         sHtml+=(((nStatus==""10"")||(nStatus==""-10""))&&(!oS.bReadOnly)&&(bUnLocked))? ""<a href='javascript:fnPopMenuClick(\""""+sCompletid+""\"",0);'>Unobtainable</a>"":""Unobtainable"";" & vbCrLf
s = s & "         sHtml+=""</td></tr>"";" & vbCrLf
s = s & "                 " & vbCrLf
s = s & "         sHtml+=""<tr height='15'><td class='clsPopMenuLinkText'>"";" & vbCrLf
s = s & "         sHtml+=((nStatus==""-5"")&&(!oS.bReadOnly)&&(bUnLocked))? ""<a href='javascript:fnPopMenuClick(\""""+sCompletid+""\"",1);'>Missing</a>"":""Missing"";" & vbCrLf
s = s & "         sHtml+=""</td></tr>"";" & vbCrLf
s = s & "         sHtml+=""<tr height='1'><td align=left width='98%' bgcolor='#C0C0C0'></td></tr>"";" & vbCrLf
s = s & " }" & vbCrLf
s = s & " if (oU.bCreateSDV)" & vbCrLf
s = s & " {" & vbCrLf
s = s & "         var sCompletid=oS.sStudy+sDel1+oS.sSite+sDel1+oS.sSubject+sDel1+sViId+sDel1+sViCycle;" & vbCrLf
s = s & "         sHtml+=""<tr height='15'><td class='clsPopMenuLinkText'>"";" & vbCrLf
s = s & "         sHtml+=""<a href='javascript:fnPopMenuClick(\""""+sCompletid+""\"",3);'>Visit SDV...</a>"";" & vbCrLf
s = s & "         sHtml+=""</td></tr>"";" & vbCrLf
s = s & "    }" & vbCrLf
s = s & "    sHtml+=""</table>"";" & vbCrLf
s = s & " document.all['divPopMenu'].innerHTML=sHtml;" & vbCrLf
s = s & " fnPopMenuShow(document.all['divPopMenu'])" & vbCrLf
s = s & "}" & vbCrLf
s = s & "" & vbCrLf
s = s & "function fnE(nBtn,sEfTskId,sEfId,sEfCycle,sEfTitle,sViId,sViCycle,sViTitle,nStatus,bLocked,bFrozen,bCanUnFreeze)" & vbCrLf
s = s & "{" & vbCrLf
s = s & " gsETitle=sEfTitle;" & vbCrLf
s = s & " gsVTitle=sViTitle;" & vbCrLf
s = s & "" & vbCrLf
s = s & " if (nBtn==1)" & vbCrLf
s = s & "    {" & vbCrLf
s = s & "         //if(CanOpeneForm(nStatus,bLocked,bFrozen))" & vbCrLf
s = s & "         if (oU.bViewData)" & vbCrLf
s = s & "         {" & vbCrLf
s = s & "                 if((nStatus==-10)&&(bLocked||bFrozen))" & vbCrLf
s = s & "                 {" & vbCrLf
s = s & "                         alert(""This locked eForm contains no data and cannot be opened"");" & vbCrLf
s = s & "                 }" & vbCrLf
s = s & "                 else if((nStatus==-10)&&(!oU.bChangeData))" & vbCrLf
s = s & "                 {" & vbCrLf
s = s & "                         alert(""You may not enter new data for this subject"");" & vbCrLf
s = s & "                 }" & vbCrLf
s = s & "                 else" & vbCrLf
s = s & "                 {" & vbCrLf
s = s & "                         window.parent.fnEformUrl(oS.sStudy,oS.sSite,oS.sSubject,sEfTskId,"""",undefined,window.sWinState);" & vbCrLf
s = s & "                 }" & vbCrLf
s = s & "         }" & vbCrLf
s = s & "         else" & vbCrLf
s = s & "         {" & vbCrLf
s = s & "                 alert(""You do not have permission to view data"");" & vbCrLf
s = s & "         }" & vbCrLf
s = s & "    }" & vbCrLf
s = s & "    else" & vbCrLf
s = s & "    {" & vbCrLf
s = s & "         var bUnLocked=((!bLocked)&&(!bFrozen));" & vbCrLf
s = s & "         var nLFScope=3;" & vbCrLf
s = s & "         var nLFAction=0;" & vbCrLf
s = s & "         var sHtml="""";" & vbCrLf
s = s & "        sHtml+=""<table width='130'>"";" & vbCrLf
s = s & "        var bSep=false;" & vbCrLf
s = s & "        " & vbCrLf
s = s & "        if (oU.bViewData)" & vbCrLf
s = s & "        {" & vbCrLf
s = s & "                 if(((nStatus==-10)&&(bLocked||bFrozen))||((nStatus==-10)&&(!oU.bChangeData)))" & vbCrLf
s = s & "                 {" & vbCrLf
s = s & "                         sHtml+=""<tr height='15'><td class='clsPopMenuLinkText'>Open...</td></tr>"";" & vbCrLf
s = s & "                         sHtml+=""<tr><td align=left><hr width='98%' size='1' color='#C0C0C0'></hr></td></tr>"";" & vbCrLf
s = s & "                 }" & vbCrLf
s = s & "                 else" & vbCrLf
s = s & "                 {" & vbCrLf
s = s & "                         sHtml+=""<tr height='15'><td class='clsPopMenuLinkText'><a href='javascript:fnE(1,\""""+sEfTskId+""\"");'><b>Open...</b></a></td></tr>"";" & vbCrLf
s = s & "                         sHtml+=""<tr height='1'><td align=left width='98%' bgcolor='#C0C0C0'></td></tr>"";" & vbCrLf
s = s & "                 }" & vbCrLf
s = s & "         }" & vbCrLf
s = s & "         if (oU.bLockData)" & vbCrLf
s = s & "         {" & vbCrLf
s = s & "                 if(bUnLocked)" & vbCrLf
s = s & "                 {" & vbCrLf
s = s & "                         //Lock" & vbCrLf
s = s & "                         var sCompletid=oS.sStudy+sDel1+oS.sSite+sDel1+oS.sSubject+sDel1+sViId+sDel1+sViCycle+sDel1+sEfId+sDel1+sEfCycle;" & vbCrLf
s = s & "                         nLFAction=1;" & vbCrLf
s = s & "                         sCompletid+=sDel1+nLFScope+sDel1+nLFAction;" & vbCrLf
s = s & "                         sHtml+=""<tr height='15'><td class='clsPopMenuLinkText'>"";" & vbCrLf
s = s & "                         sHtml+=""<a href='javascript:fnPopMenuClick(\""""+sCompletid+""\"",5);'>Lock</a>"";" & vbCrLf
s = s & "                         sHtml+=""</td></tr>"";" & vbCrLf
s = s & "                 }" & vbCrLf
s = s & "                 else" & vbCrLf
s = s & "                 {" & vbCrLf
s = s & "                         sHtml+=""<tr height='15'><td class='clsPopMenuLinkText'>Lock</td></tr>"";" & vbCrLf
s = s & "                 }" & vbCrLf
s = s & "                 bSep=true;" & vbCrLf
s = s & "         }" & vbCrLf
s = s & "         if (oU.bLockData)" & vbCrLf
s = s & "         {" & vbCrLf
s = s & "                 if(bLocked)" & vbCrLf
s = s & "                 {" & vbCrLf
s = s & "                         //Unlock" & vbCrLf
s = s & "                         var sCompletid=oS.sStudy+sDel1+oS.sSite+sDel1+oS.sSubject+sDel1+sViId+sDel1+sViCycle+sDel1+sEfId+sDel1+sEfCycle;" & vbCrLf
s = s & "                         nLFAction=0;" & vbCrLf
s = s & "                         sCompletid+=sDel1+nLFScope+sDel1+nLFAction;" & vbCrLf
s = s & "                         sHtml+=""<tr height='15'><td class='clsPopMenuLinkText'>"";" & vbCrLf
s = s & "                         sHtml+=""<a href='javascript:fnPopMenuClick(\""""+sCompletid+""\"",5);'>Unlock</a>"";" & vbCrLf
s = s & "                         sHtml+=""</td></tr>"";" & vbCrLf
s = s & "                 }" & vbCrLf
s = s & "                 else" & vbCrLf
s = s & "                 {" & vbCrLf
s = s & "                         sHtml+=""<tr height='15'><td class='clsPopMenuLinkText'>Unlock</td></tr>"";" & vbCrLf
s = s & "                 }" & vbCrLf
s = s & "                 bSep=true;" & vbCrLf
s = s & "         }" & vbCrLf
s = s & "         if (oU.bFreezeData)" & vbCrLf
s = s & "         {" & vbCrLf
s = s & "                 if(!bFrozen)" & vbCrLf
s = s & "                 {" & vbCrLf
s = s & "                         //Freeze" & vbCrLf
s = s & "                         var sCompletid=oS.sStudy+sDel1+oS.sSite+sDel1+oS.sSubject+sDel1+sViId+sDel1+sViCycle+sDel1+sEfId+sDel1+sEfCycle;" & vbCrLf
s = s & "                         nLFAction=2;" & vbCrLf
s = s & "                         sCompletid+=sDel1+nLFScope+sDel1+nLFAction;" & vbCrLf
s = s & "                         sHtml+=""<tr height='15'><td class='clsPopMenuLinkText'>"";" & vbCrLf
s = s & "                         sHtml+=""<a href='javascript:fnPopMenuClick(\""""+sCompletid+""\"",5);'>Freeze</a>"";" & vbCrLf
s = s & "                         sHtml+=""</td></tr>"";" & vbCrLf
s = s & "                 }" & vbCrLf
s = s & "                 else" & vbCrLf
s = s & "                 {" & vbCrLf
s = s & "                         sHtml+=""<tr height='15'><td class='clsPopMenuLinkText'>Freeze</td></tr>"";" & vbCrLf
s = s & "                 }" & vbCrLf
s = s & "                 bSep=true;" & vbCrLf
s = s & "         }" & vbCrLf
s = s & "         if (oU.bUnFreezeData)" & vbCrLf
s = s & "         {" & vbCrLf
s = s & "                 if(bCanUnFreeze)" & vbCrLf
s = s & "                 {" & vbCrLf
s = s & "                         //UnFreeze" & vbCrLf
s = s & "                         var sCompletid=oS.sStudy+sDel1+oS.sSite+sDel1+oS.sSubject+sDel1+sViId+sDel1+sViCycle+sDel1+sEfId+sDel1+sEfCycle;" & vbCrLf
s = s & "                         nLFAction=3;" & vbCrLf
s = s & "                         sCompletid+=sDel1+nLFScope+sDel1+nLFAction;" & vbCrLf
s = s & "                         sHtml+=""<tr height='15'><td class='clsPopMenuLinkText'>"";" & vbCrLf
s = s & "                         sHtml+=""<a href='javascript:fnPopMenuClick(\""""+sCompletid+""\"",5);'>UnFreeze</a>"";" & vbCrLf
s = s & "                         sHtml+=""</td></tr>"";" & vbCrLf
s = s & "                 }" & vbCrLf
s = s & "                 else" & vbCrLf
s = s & "                 {" & vbCrLf
s = s & "                         sHtml+=""<tr height='15'><td class='clsPopMenuLinkText'>UnFreeze</td></tr>"";" & vbCrLf
s = s & "                 }" & vbCrLf
s = s & "                 bSep=true;" & vbCrLf
s = s & "         }" & vbCrLf
s = s & "         if(bSep)" & vbCrLf
s = s & "         {" & vbCrLf
s = s & "                 sHtml+=""<tr height='1'><td align=left width='98%' bgcolor='#C0C0C0'></td></tr>"";" & vbCrLf
s = s & "         }" & vbCrLf
s = s & "         if (oU.bChangeData)" & vbCrLf
s = s & "         {" & vbCrLf
s = s & "                 var sCompletid=oS.sStudy+sDel1+oS.sSite+sDel1+oS.sSubject+sDel1+sViId+sDel1+sViCycle+sDel1+sDel1+sEfTskId+sDel1+""e"";" & vbCrLf
s = s & "                 sHtml+=""<tr height='15'><td class='clsPopMenuLinkText'>"";" & vbCrLf
s = s & "                 sHtml+=(((nStatus==""10"")||(nStatus==""-10""))&&(!oS.bReadOnly)&&(bUnLocked))? ""<a href='javascript:fnPopMenuClick(\""""+sCompletid+""\"",0);'>Unobtainable</a>"":""Unobtainable"";" & vbCrLf
s = s & "                 sHtml+=""</td></tr>"";" & vbCrLf
s = s & "                 " & vbCrLf
s = s & "                 sHtml+=""<tr height='15'><td class='clsPopMenuLinkText'>"";" & vbCrLf
s = s & "                 sHtml+=((nStatus==""-5"")&&(!oS.bReadOnly)&&(bUnLocked))? ""<a href='javascript:fnPopMenuClick(\""""+sCompletid+""\"",1);'>Missing</a>"":""Missing"";" & vbCrLf
s = s & "                 sHtml+=""</td></tr>"";" & vbCrLf
s = s & "                 sHtml+=""<tr height='1'><td align=left width='98%' bgcolor='#C0C0C0'></td></tr>"";" & vbCrLf
s = s & "         }" & vbCrLf
s = s & "         if (oU.bCreateSDV)" & vbCrLf
s = s & "         {" & vbCrLf
s = s & "                 var sCompletid=oS.sStudy+sDel1+oS.sSite+sDel1+oS.sSubject+sDel1+sViId+sDel1+sViCycle+sDel1+sDel1+sDel1+sDel1+sEfTskId;" & vbCrLf
s = s & "                 if (bUnLocked)" & vbCrLf
s = s & "                 {" & vbCrLf
s = s & "                         sHtml+=""<tr height='15'><td class='clsPopMenuLinkText'>"";" & vbCrLf
s = s & "                         sHtml+=""<a href='javascript:fnPopMenuClick(\""""+sCompletid+""\"",2);'>EForm SDV...</a>"";" & vbCrLf
s = s & "                         sHtml+=""</td></tr>"";" & vbCrLf
s = s & "                 }" & vbCrLf
s = s & "                 else" & vbCrLf
s = s & "                 {" & vbCrLf
s = s & "                         sHtml+=""<tr height='15'><td class='clsPopMenuLinkText'>EForm SDV...</td></tr>"";" & vbCrLf
s = s & "                 }" & vbCrLf
s = s & "                 " & vbCrLf
s = s & "                 sHtml+=""<tr height='15'><td class='clsPopMenuLinkText'>"";" & vbCrLf
s = s & "                 sHtml+=""<a href='javascript:fnPopMenuClick(\""""+sCompletid+""\"",3);'>Visit SDV...</a>"";" & vbCrLf
s = s & "                 sHtml+=""</td></tr>"";" & vbCrLf
s = s & "                 " & vbCrLf
s = s & "                 sHtml+=""<tr height='15'><td class='clsPopMenuLinkText'>"";" & vbCrLf
s = s & "                 sHtml+=""<a href='javascript:fnPopMenuClick(\""""+sCompletid+""\"",4);'>Subject SDV...</a>"";" & vbCrLf
s = s & "                 sHtml+=""</td></tr>"";" & vbCrLf
s = s & "         }" & vbCrLf
s = s & "        sHtml+=""</table>"";" & vbCrLf
s = s & "        " & vbCrLf
s = s & "        document.all['divPopMenu'].innerHTML=sHtml;" & vbCrLf
s = s & "        fnPopMenuShow(document.all['divPopMenu']);" & vbCrLf
s = s & "    }" & vbCrLf
s = s & "}" & vbCrLf
s = s & "                        " & vbCrLf
s = s & "function fnPopMenuClick(id,nAct,sTitle)" & vbCrLf
s = s & "{" & vbCrLf
s = s & " switch (nAct)" & vbCrLf
s = s & " {" & vbCrLf
s = s & "         case 0:" & vbCrLf
s = s & "                 //unobtainable" & vbCrLf
s = s & "                 var sText="""";" & vbCrLf
s = s & "                 switch (id.charAt(id.length-1))" & vbCrLf
s = s & "                 {" & vbCrLf
s = s & "                         case ""e"":" & vbCrLf
s = s & "                                 sText=""eForm"";" & vbCrLf
s = s & "                                 break;" & vbCrLf
s = s & "                         case ""v"":" & vbCrLf
s = s & "                                 sText=""Visit"";" & vbCrLf
s = s & "                                 break;" & vbCrLf
s = s & "                         case ""s"":" & vbCrLf
s = s & "                                 sText=""Subject"";" & vbCrLf
s = s & "                                 break;" & vbCrLf
s = s & "                 }" & vbCrLf
s = s & "                 if (confirm(""Are you sure you want to change this "" + sText + "" to unobtainable?""))" & vbCrLf
s = s & "                 {" & vbCrLf
s = s & "                         sRtn=""u"";" & vbCrLf
s = s & "                 }" & vbCrLf
s = s & "                 break;" & vbCrLf
s = s & "         case 1:" & vbCrLf
s = s & "                 //missing" & vbCrLf
s = s & "                 var sText="""";" & vbCrLf
s = s & "                 switch (id.charAt(id.length-1))" & vbCrLf
s = s & "                 {" & vbCrLf
s = s & "                         case ""e"":" & vbCrLf
s = s & "                                 sText=""eForm"";" & vbCrLf
s = s & "                                 break;" & vbCrLf
s = s & "                         case ""v"":" & vbCrLf
s = s & "                                 sText=""Visit"";" & vbCrLf
s = s & "                                 break;" & vbCrLf
s = s & "                         case ""s"":" & vbCrLf
s = s & "                                 sText=""Subject"";" & vbCrLf
s = s & "                                 break;" & vbCrLf
s = s & "                 }" & vbCrLf
s = s & "                 if (confirm(""Are you sure you want to change this "" + sText + "" to missing?""))" & vbCrLf
s = s & "                 {" & vbCrLf
s = s & "                         sRtn=""m"";" & vbCrLf
s = s & "                 }" & vbCrLf
s = s & "                 break;" & vbCrLf
s = s & "         case 2:" & vbCrLf
s = s & "         case 3:" & vbCrLf
s = s & "         case 4:" & vbCrLf
s = s & "                 var aArgs=new Array();" & vbCrLf
s = s & "                 var sType="""";" & vbCrLf
s = s & "                 switch (nAct)" & vbCrLf
s = s & "                 {" & vbCrLf
s = s & "                         case 2: sType=""e"";aArgs[0]=gsETitle;break;" & vbCrLf
s = s & "                         case 3: sType=""v"";aArgs[0]=gsVTitle;break;" & vbCrLf
s = s & "                         default: sType=""s"";aArgs[0]=oS.Label+""(""+oS.sSubject+"")"";break;" & vbCrLf
s = s & "                 }" & vbCrLf
s = s & "                 aArgs[1]="""";" & vbCrLf
s = s & "                 " & vbCrLf
s = s & "                 //eform sdv" & vbCrLf
s = s & "                 var sRtn=window.showModalDialog('DialogNewSDV.htm',aArgs,'dialogHeight:300px;dialogWidth:500px;center:yes;status:0;dependent,scrollbars');" & vbCrLf
s = s & "                 sRtn+=((sRtn!=undefined)&&(sRtn!=""""))? sDel1+sType:"""";" & vbCrLf
s = s & "                 break;" & vbCrLf
s = s & "         case 5:" & vbCrLf
s = s & "                 //subject/visit/eForm lock" & vbCrLf
s = s & "                 var sRtn=""l"";" & vbCrLf
s = s & "                 break;" & vbCrLf
s = s & " }" & vbCrLf
s = s & " if ((sRtn!=undefined)&&(sRtn!=""""))" & vbCrLf
s = s & " {" & vbCrLf
s = s & "         window.document.Form1.SchedUpdate.value=sRtn;" & vbCrLf
s = s & "         window.document.Form1.SchedIdentifier.value=id;" & vbCrLf
s = s & "         window.document.Form1.submit();" & vbCrLf
s = s & " }       " & vbCrLf
s = s & "}" & vbCrLf
s = s & "" & vbCrLf
s = s & "// Hide the loader" & vbCrLf
s = s & "function fnHideLoader()" & vbCrLf
s = s & "{" & vbCrLf
s = s & " document.all.divMsgBox.style.visibility='hidden';" & vbCrLf
s = s & "}" & vbCrLf
s = s & "" & vbCrLf
s = s & "function fnPopMenuHide()" & vbCrLf
s = s & "{" & vbCrLf
s = s & " document.all[""divPopMenu""].style.visibility='hidden'" & vbCrLf
s = s & "}" & vbCrLf
s = s & "" & vbCrLf
s = s & "function fnPopMenuShow(oDiv)" & vbCrLf
s = s & "{" & vbCrLf
s = s & " var nPopHeight=oDiv.clientHeight;" & vbCrLf
s = s & " var nPopWidth=oDiv.clientWidth;" & vbCrLf
s = s & " var nPopYPosition=window.event.clientY;" & vbCrLf
s = s & " var nPopXPosition=window.event.clientX;" & vbCrLf
s = s & " var nVisibleScreenHeight=document.body.clientHeight;" & vbCrLf
s = s & " var nVisibleScreenWidth=document.body.clientWidth;" & vbCrLf
s = s & " var nX=0;" & vbCrLf
s = s & " var nY=0;" & vbCrLf
s = s & " " & vbCrLf
s = s & " if((nVisibleScreenHeight-(nPopYPosition+nPopHeight)>0)||((nVisibleScreenHeight-(nPopYPosition+nPopHeight))>(nPopYPosition-nPopHeight)))" & vbCrLf
s = s & " {" & vbCrLf
s = s & "         //if space below, display below" & vbCrLf
s = s & "         nY=nPopYPosition;" & vbCrLf
s = s & " }" & vbCrLf
s = s & " else" & vbCrLf
s = s & " {" & vbCrLf
s = s & "         //display above" & vbCrLf
s = s & "         nY=nPopYPosition-nPopHeight;" & vbCrLf
s = s & " }" & vbCrLf
s = s & " if((nVisibleScreenWidth-(nPopXPosition+nPopWidth)>0)||((nVisibleScreenWidth-(nPopXPosition+nPopWidth))>(nPopXPosition-nPopWidth)))" & vbCrLf
s = s & " {" & vbCrLf
s = s & "         //if space right, display right" & vbCrLf
s = s & "         nX=nPopXPosition;" & vbCrLf
s = s & " }" & vbCrLf
s = s & " else" & vbCrLf
s = s & " {" & vbCrLf
s = s & "         //display left" & vbCrLf
s = s & "         nX=nPopXPosition-nPopWidth;" & vbCrLf
s = s & " }" & vbCrLf
s = s & "    oDiv.style.pixelLeft=document.body.scrollLeft+nX;" & vbCrLf
s = s & "    oDiv.style.pixelTop=document.body.scrollTop+nY;" & vbCrLf
s = s & "    oDiv.style.visibility='visible';" & vbCrLf
s = s & "}" & vbCrLf
s = s & "document.onclick=fnPopMenuHide;" & vbCrLf
s = s & "/*<!--r-->*/"
CompiledScheduleJS = s
End Function
'-----------------------------------------------------------------------------
Public Function CompiledRowOverJS() As String
'-----------------------------------------------------------------------------
Dim s As String
s = ""
s = s & "///////////////////////////////////////////////////////////////////////////////////////////" & vbCrLf
s = s & "//" & vbCrLf
s = s & "//       (c) InferMed 2003" & vbCrLf
s = s & "//" & vbCrLf
s = s & "//       add onmouseover='fnOnMouseOver(this,nNumHeaderRows)' for row hover" & vbCrLf
s = s & "//       add onmouseout='fnOnMouseOut(this)' for row hover" & vbCrLf
s = s & "//       add onclick/onmousedown/onmouseup='fnOnClick(this)' for row select" & vbCrLf
s = s & "//" & vbCrLf
s = s & "///////////////////////////////////////////////////////////////////////////////////////////" & vbCrLf
s = s & "" & vbCrLf
s = s & "var aTableObjects=new Array()" & vbCrLf
s = s & "" & vbCrLf
s = s & "//var oCurrentRow=null;                  //tracks current mouseover row" & vbCrLf
s = s & "//var sHoverBColour="""";                        //tracks previous backgroundColor of mouseover row" & vbCrLf
s = s & "//var sHoverFColour="""";                        //tracks previous color of mouseover row                        " & vbCrLf
s = s & "var sHOVERBCOLOUR='#e0e0ff';" & vbCrLf
s = s & "var sHOVERFCOLOUR='#0000ff';" & vbCrLf
s = s & "var sSELECTBCOLOUR='#0000ff';" & vbCrLf
s = s & "var sSELECTFCOLOUR='#ffffff';" & vbCrLf
s = s & "" & vbCrLf
s = s & "function fnPushTableObject(oTableObject)" & vbCrLf
s = s & "{" & vbCrLf
s = s & " aTableObjects.push(oTableObject);" & vbCrLf
s = s & "}" & vbCrLf
s = s & "function fnAddTableObject(oTable)" & vbCrLf
s = s & "{" & vbCrLf
s = s & "//       alert(""creating ""+oTable.id)" & vbCrLf
s = s & " var oTO=new Object();" & vbCrLf
s = s & " oTO.sID=oTable.id;" & vbCrLf
s = s & " " & vbCrLf
s = s & " oTO.oCurrentRow=null;" & vbCrLf
s = s & " oTO.sHoverBColour="""";" & vbCrLf
s = s & " oTO.sHoverFColour="""";" & vbCrLf
s = s & " " & vbCrLf
s = s & " oTO.oSelectRow=null;            //tracks currently selected row" & vbCrLf
s = s & " oTO.sSelectBColour="""";                //tracks previous backgroundColor of selected row" & vbCrLf
s = s & " oTO.sSelectFColour="""";                //tracks previous Color of selected row" & vbCrLf
s = s & " fnPushTableObject(oTO);" & vbCrLf
s = s & " return oTO;" & vbCrLf
s = s & "}" & vbCrLf
s = s & "function fnGetTableObject(oTable)" & vbCrLf
s = s & "{" & vbCrLf
s = s & " for(var n=0;n<aTableObjects.length;n++)" & vbCrLf
s = s & " {" & vbCrLf
s = s & "         if(aTableObjects[n].sID==oTable.id)" & vbCrLf
s = s & "         {" & vbCrLf
s = s & "                 return aTableObjects[n]" & vbCrLf
s = s & "         }" & vbCrLf
s = s & " }" & vbCrLf
s = s & " return fnAddTableObject(oTable);" & vbCrLf
s = s & "}" & vbCrLf
s = s & "function fnSelectRow(oTable,nRowIndex)" & vbCrLf
s = s & "{" & vbCrLf
s = s & " var oTableObject=fnGetTableObject(oTable);" & vbCrLf
s = s & " oRow=oTable.rows[nRowIndex];" & vbCrLf
s = s & " if (oTableObject.oSelectRow!=null)" & vbCrLf
s = s & " {" & vbCrLf
s = s & "         fnColourRow(oTableObject.oSelectRow,oTableObject.sSelectFColour,oTableObject.sSelectBColour);" & vbCrLf
s = s & " }       " & vbCrLf
s = s & " oTableObject.sSelectFColour="""" //sHoverFColour;" & vbCrLf
s = s & " oTableObject.sSelectBColour="""" //sHoverBColour;" & vbCrLf
s = s & " fnColourRow(oRow,sSELECTFCOLOUR,sSELECTBCOLOUR)" & vbCrLf
s = s & " oTableObject.oSelectRow=oRow;" & vbCrLf
s = s & " oTableObject.oCurrentRow=null;" & vbCrLf
s = s & "}" & vbCrLf
s = s & "function fnColourRow(oRow,sFColour,sBColour)" & vbCrLf
s = s & "{" & vbCrLf
s = s & " oRow.style.backgroundColor=sBColour;" & vbCrLf
s = s & " oRow.style.color=sFColour;" & vbCrLf
s = s & "}" & vbCrLf
s = s & "function fnOnClick(oTable,nNumHeaderRows)" & vbCrLf
s = s & "{" & vbCrLf
s = s & " var oTableObject=fnGetTableObject(oTable);" & vbCrLf
s = s & " nNumHeaderRows=(nNumHeaderRows!=undefined)?nNumHeaderRows:0;" & vbCrLf
s = s & " var oRow=GetRow(window.event.srcElement)" & vbCrLf
s = s & " if (oRow==null) return true;" & vbCrLf
s = s & " if (oRow!=oTableObject.oSelectRow)" & vbCrLf
s = s & " {       " & vbCrLf
s = s & "         if (oTableObject.oSelectRow!=null)" & vbCrLf
s = s & "         {" & vbCrLf
s = s & "//alert(oTableObject.oSelectRow+""*""+oTableObject.sID+""*""+oTableObject.sSelectFColour+""*""+oTableObject.sSelectBColour)              " & vbCrLf
s = s & "                 fnColourRow(oTableObject.oSelectRow,oTableObject.sSelectFColour,oTableObject.sSelectBColour);" & vbCrLf
s = s & "         }" & vbCrLf
s = s & "         if (oRow.rowIndex>=nNumHeaderRows)" & vbCrLf
s = s & "         {" & vbCrLf
s = s & "                 oTableObject.sSelectFColour=sHoverFColour;" & vbCrLf
s = s & "                 oTableObject.sSelectBColour=sHoverBColour;" & vbCrLf
s = s & "                 fnColourRow(oRow,sSELECTFCOLOUR,sSELECTBCOLOUR)" & vbCrLf
s = s & "                 oTableObject.oSelectRow=oRow;" & vbCrLf
s = s & "         }" & vbCrLf
s = s & "         oTableObject.oCurrentRow=null;" & vbCrLf
s = s & " }" & vbCrLf
s = s & "}" & vbCrLf
s = s & "function fnOnMouseOver(oTable,nNumHeaderRows)" & vbCrLf
s = s & "{" & vbCrLf
s = s & " var oTableObject=fnGetTableObject(oTable);" & vbCrLf
s = s & " nNumHeaderRows=(nNumHeaderRows!=undefined)?nNumHeaderRows:0;" & vbCrLf
s = s & " var oRow=GetRow(window.event.srcElement)" & vbCrLf
s = s & " if (oRow==null) return true;" & vbCrLf
s = s & "//window.status=oRow.id+"" ""+oTableObject.oSelectRow.id;" & vbCrLf
s = s & " if ((oRow!=oTableObject.oCurrentRow)&&(oRow!=oTableObject.oSelectRow))" & vbCrLf
s = s & " {" & vbCrLf
s = s & "         if (oTableObject.oCurrentRow!=null)" & vbCrLf
s = s & "         {" & vbCrLf
s = s & "                 fnColourRow(oTableObject.oCurrentRow,sHoverFColour,sHoverBColour);" & vbCrLf
s = s & "         }" & vbCrLf
s = s & "         if (oRow.rowIndex>=nNumHeaderRows)" & vbCrLf
s = s & "         {" & vbCrLf
s = s & "                 sHoverFColour=oRow.currentStyle.color;" & vbCrLf
s = s & "                 sHoverBColour=oRow.currentStyle.backgroundColor;" & vbCrLf
s = s & "                 fnColourRow(oRow,sHOVERFCOLOUR,sHOVERBCOLOUR)" & vbCrLf
s = s & "                 oTableObject.oCurrentRow=oRow;" & vbCrLf
s = s & "         }" & vbCrLf
s = s & " }" & vbCrLf
s = s & "}" & vbCrLf
s = s & "function fnOnMouseOut(oTable)" & vbCrLf
s = s & "{" & vbCrLf
s = s & " var oTableObject=fnGetTableObject(oTable);" & vbCrLf
s = s & " if (oTableObject.oCurrentRow!=null)" & vbCrLf
s = s & " {" & vbCrLf
s = s & "         fnColourRow(oTableObject.oCurrentRow,sHoverFColour,sHoverBColour);" & vbCrLf
s = s & " }" & vbCrLf
s = s & " oTableObject.oCurrentRow=null;" & vbCrLf
s = s & "}" & vbCrLf
s = s & "function GetRow(oElem)" & vbCrLf
s = s & "{" & vbCrLf
s = s & " while (oElem)" & vbCrLf
s = s & " {" & vbCrLf
s = s & "         if (oElem.tagName.toLowerCase() == ""tr""" & vbCrLf
s = s & "             && oElem.parentElement.tagName.toLowerCase() == ""tbody"") " & vbCrLf
s = s & "             return oElem;" & vbCrLf
s = s & "         if (oElem.tagName.toLowerCase() == ""table"") return null;" & vbCrLf
s = s & "         oElem = oElem.parentElement;" & vbCrLf
s = s & " }" & vbCrLf
s = s & "}"
CompiledRowOverJS = s
End Function
'-----------------------------------------------------------------------------
Public Function CompiledMenuTopJS() As String
'-----------------------------------------------------------------------------
Dim s As String
s = ""
s = s & "///////////////////////////////////////////////////////////////////////////////////////////" & vbCrLf
s = s & "//" & vbCrLf
s = s & "//       (c) InferMed 2003" & vbCrLf
s = s & "//" & vbCrLf
s = s & "//       top menu event handlers" & vbCrLf
s = s & "//" & vbCrLf
s = s & "///////////////////////////////////////////////////////////////////////////////////////////" & vbCrLf
s = s & "" & vbCrLf
s = s & "var bHidden=false;" & vbCrLf
s = s & "" & vbCrLf
s = s & "function fnLogOutUrl()" & vbCrLf
s = s & "{" & vbCrLf
s = s & " window.parent.window.frames[4].fnSaveDataFirst('fnLogOutUrl()');" & vbCrLf
s = s & "}" & vbCrLf
s = s & "function fnHoldUrl()" & vbCrLf
s = s & "{" & vbCrLf
s = s & " window.parent.window.frames[4].fnSaveDataFirst('fnHoldUrl(""'+top.fnGetAppUrl(true)+'&act=standby"")');" & vbCrLf
s = s & "}" & vbCrLf
s = s & "function fnSwitchUrl()" & vbCrLf
s = s & "{" & vbCrLf
s = s & " window.parent.window.frames[4].fnSaveDataFirst('fnSwitchUrl(""'+top.fnGetAppUrl(false)+'&act=switch"")');" & vbCrLf
s = s & "}" & vbCrLf
s = s & "function fnPageLoaded()" & vbCrLf
s = s & "{" & vbCrLf
s = s & " fnInitialiseButton('topMenu','clsHoverButton clsHoverButtonActive','clsHoverButton clsHoverButtonInactive','',false);" & vbCrLf
s = s & "}" & vbCrLf
s = s & "function fnOnMouseOut(oImg)" & vbCrLf
s = s & "{" & vbCrLf
s = s & " if(bHidden)" & vbCrLf
s = s & " {" & vbCrLf
s = s & "         oImg.src='../img/exp_horiz_inactive.gif'" & vbCrLf
s = s & " }" & vbCrLf
s = s & "    else" & vbCrLf
s = s & "    {" & vbCrLf
s = s & "         oImg.src='../img/col_horiz_inactive.gif'" & vbCrLf
s = s & " }" & vbCrLf
s = s & "}" & vbCrLf
s = s & "function fnOnClick(oImg)" & vbCrLf
s = s & "{" & vbCrLf
s = s & " if(bHidden)" & vbCrLf
s = s & " {" & vbCrLf
s = s & "//<!--r-->" & vbCrLf
s = s & "//<!--r-->               " & vbCrLf
s = s & "         oImg.src='../img/col_horiz_active.gif';" & vbCrLf
s = s & "         oImg.alt='Hide menu';" & vbCrLf
s = s & "         bHidden=false" & vbCrLf
s = s & " }" & vbCrLf
s = s & " else" & vbCrLf
s = s & " {" & vbCrLf
s = s & "//<!--r-->" & vbCrLf
s = s & "//<!--r-->       " & vbCrLf
s = s & "         oImg.src='../img/exp_horiz_active.gif';" & vbCrLf
s = s & "        oImg.alt='Show menu';" & vbCrLf
s = s & "        bHidden=true;" & vbCrLf
s = s & "    }" & vbCrLf
s = s & "}" & vbCrLf
s = s & "function fnOnMouseOver(oImg)" & vbCrLf
s = s & "{" & vbCrLf
s = s & " if(bHidden)" & vbCrLf
s = s & " {" & vbCrLf
s = s & "         oImg.src='../img/exp_horiz_active.gif'" & vbCrLf
s = s & " }" & vbCrLf
s = s & " else" & vbCrLf
s = s & " {" & vbCrLf
s = s & "         oImg.src='../img/col_horiz_active.gif'" & vbCrLf
s = s & " }" & vbCrLf
s = s & "}"
CompiledMenuTopJS = s
End Function
'-----------------------------------------------------------------------------
Public Function CompiledSelectListJS() As String
'-----------------------------------------------------------------------------
Dim s As String
s = ""
s = s & "////////////////////" & vbCrLf
s = s & "////////////////////" & vbCrLf
s = s & "// Public methods" & vbCrLf
s = s & "////////////////////" & vbCrLf
s = s & "////////////////////" & vbCrLf
s = s & "" & vbCrLf
s = s & "//" & vbCrLf
s = s & "// Create a slect list control." & vbCrLf
s = s & "//" & vbCrLf
s = s & "// sLocation             = DOM textual reference to the container object eg ""window.document""" & vbCrLf
s = s & "// sID                           = identification string for this control. name to be used for form element" & vbCrLf
s = s & "// sValues                       = delimited value-pair list of select list items" & vbCrLf
s = s & "//                                               (pairs delimited with ""|"", items within pair delimited with ""`"")" & vbCrLf
s = s & "// nTabIndex             = the control's tab index" & vbCrLf
s = s & "// nWidth                        = pixel width" & vbCrLf
s = s & "// nHeight                       = pixel height" & vbCrLf
s = s & "// nAlign                        = justification of text" & vbCrLf
s = s & "" & vbCrLf
s = s & "//" & vbCrLf
s = s & "// Returns a reference to the select object," & vbCrLf
s = s & "//       which supports the following public methods:" & vbCrLf
s = s & "//" & vbCrLf
s = s & "//global array of select objects" & vbCrLf
s = s & "var aSelectObjects=new Array();" & vbCrLf
s = s & "" & vbCrLf
s = s & "//global enums" & vbCrLf
s = s & "var eAlignLeft=0;" & vbCrLf
s = s & "var eAlignCentre=1;" & vbCrLf
s = s & "var eAlignRight=2;" & vbCrLf
s = s & "" & vbCrLf
s = s & "function fnPushSelect(oSelect)" & vbCrLf
s = s & "{" & vbCrLf
s = s & " aSelectObjects.push(oSelect);" & vbCrLf
s = s & "}" & vbCrLf
s = s & "function fnPopSelect(sID)" & vbCrLf
s = s & "{" & vbCrLf
s = s & " for(var n=0;n<aSelectObjects.length;n++)" & vbCrLf
s = s & " {" & vbCrLf
s = s & "         if(aSelectObjects[n].sID==sID) return aSelectObjects[n];" & vbCrLf
s = s & " }" & vbCrLf
s = s & " return null;" & vbCrLf
s = s & "}" & vbCrLf
s = s & "function fnInitZOrder()" & vbCrLf
s = s & "{" & vbCrLf
s = s & " //short term solution to z-index problems when innerhtml is changed" & vbCrLf
s = s & " for (var n=0;n<aSelectObjects.length;n++)" & vbCrLf
s = s & " {" & vbCrLf
s = s & "         fnSelectOpen(aSelectObjects[n]);" & vbCrLf
s = s & "         fnSelectClose(aSelectObjects[n]);" & vbCrLf
s = s & " }" & vbCrLf
s = s & "}" & vbCrLf
s = s & "function fnDocumentOnClick()" & vbCrLf
s = s & "{" & vbCrLf
s = s & " var sID="""";" & vbCrLf
s = s & " oElement=window.event.srcElement;" & vbCrLf
s = s & " while ((oElement.id.indexOf(""sel_table"")==-1)&&(oElement.tagName.toLowerCase()!=""body""))" & vbCrLf
s = s & " {" & vbCrLf
s = s & "         oElement=oElement.parentElement;" & vbCrLf
s = s & " }" & vbCrLf
s = s & " if(oElement.id.indexOf(""sel_table"")!=-1)" & vbCrLf
s = s & " {" & vbCrLf
s = s & "         //click event originated on select list" & vbCrLf
s = s & "         sID=oElement.id.slice(10);" & vbCrLf
s = s & " }" & vbCrLf
s = s & " fnSelectCloseAll(sID);" & vbCrLf
s = s & "}" & vbCrLf
s = s & "function fnSelectCreate(sLocation,sID,nTabIndex,nWidth,nHeight,nAlign)" & vbCrLf
s = s & "{" & vbCrLf
s = s & " var oSelect=new Object();" & vbCrLf
s = s & " oSelect.sLocation=sLocation+"".all.""+sID+""_c"";  //container" & vbCrLf
s = s & " oSelect.sPLocation=sLocation+"".all.""+sID+""_p""; //pane" & vbCrLf
s = s & " oSelect.sVLocation=sLocation+"".all.""+sID+""_v""; //value display" & vbCrLf
s = s & " oSelect.sFLocation=sLocation+"".all.""+sID         //hidden field" & vbCrLf
s = s & " oSelect.sTLocation=sLocation+"".all.""+sID+""_t""; //tooltip" & vbCrLf
s = s & " " & vbCrLf
s = s & " oSelect.sID=sID;" & vbCrLf
s = s & " oSelect.nWidth=nWidth;" & vbCrLf
s = s & " oSelect.nHeight=nHeight;" & vbCrLf
s = s & " oSelect.nAlign=nAlign;" & vbCrLf
s = s & " oSelect.sIndex=null;" & vbCrLf
s = s & "" & vbCrLf
s = s & "//" & vbCrLf
s = s & "// Assign the object's methods - see functions called for detailed descriptions" & vbCrLf
s = s & "//" & vbCrLf
s = s & " oSelect.setValue=function(sIndex)" & vbCrLf
s = s & " {" & vbCrLf
s = s & "         return fnSetValue(this,sIndex);" & vbCrLf
s = s & " }" & vbCrLf
s = s & " oSelect.populate=function(sList,bInit)" & vbCrLf
s = s & " {" & vbCrLf
s = s & "         return fnPopulate(this,sList,bInit);" & vbCrLf
s = s & " }" & vbCrLf
s = s & " oSelect.getIndex=function()" & vbCrLf
s = s & " {" & vbCrLf
s = s & "         return fnGetIndex(this);" & vbCrLf
s = s & " }" & vbCrLf
s = s & " oSelect.getValue=function()" & vbCrLf
s = s & " {" & vbCrLf
s = s & "         return fnGetValue(this);" & vbCrLf
s = s & " }" & vbCrLf
s = s & " oSelect.getText=function()" & vbCrLf
s = s & " {" & vbCrLf
s = s & "         return fnGetText(this);" & vbCrLf
s = s & " }" & vbCrLf
s = s & " fnPushSelect(oSelect);" & vbCrLf
s = s & " fnDraw(oSelect);" & vbCrLf
s = s & " return oSelect;" & vbCrLf
s = s & "}" & vbCrLf
s = s & "" & vbCrLf
s = s & "//////////////////////////////////////////////////" & vbCrLf
s = s & "// Private Methods - used by the object methods" & vbCrLf
s = s & "//////////////////////////////////////////////////" & vbCrLf
s = s & "" & vbCrLf
s = s & "//" & vbCrLf
s = s & "// Useful keyboard definitions - global scope" & vbCrLf
s = s & "//" & vbCrLf
s = s & "var kDown=40;" & vbCrLf
s = s & "var kUp=38;" & vbCrLf
s = s & "var kSpace=32;" & vbCrLf
s = s & "var kEnter=13;" & vbCrLf
s = s & "var kTab=9;" & vbCrLf
s = s & "" & vbCrLf
s = s & "function fnGetIndex(oSelect)" & vbCrLf
s = s & "{" & vbCrLf
s = s & " return oSelect.sIndex;" & vbCrLf
s = s & "}" & vbCrLf
s = s & "function fnGetValue(oSelect)" & vbCrLf
s = s & "{" & vbCrLf
s = s & " if (oSelect.sIndex===null)" & vbCrLf
s = s & " {" & vbCrLf
s = s & "         return """";" & vbCrLf
s = s & " }" & vbCrLf
s = s & " else" & vbCrLf
s = s & " {" & vbCrLf
s = s & "         return oSelect.sIndex;" & vbCrLf
s = s & " }" & vbCrLf
s = s & " " & vbCrLf
s = s & "}" & vbCrLf
s = s & "function fnGetText(oSelect)" & vbCrLf
s = s & "{" & vbCrLf
s = s & " if (oSelect.sIndex===null)" & vbCrLf
s = s & " {" & vbCrLf
s = s & "         return """";" & vbCrLf
s = s & " }" & vbCrLf
s = s & " else" & vbCrLf
s = s & " {" & vbCrLf
s = s & "         return oSelect.olNames[oSelect.sIndex];" & vbCrLf
s = s & " }" & vbCrLf
s = s & "}" & vbCrLf
s = s & "function fnSetValue(oSelect,sIndex)" & vbCrLf
s = s & "{" & vbCrLf
s = s & "//       if(sIndex!=null)" & vbCrLf
s = s & "//       {" & vbCrLf
s = s & "         oSelect.sIndex=sIndex;" & vbCrLf
s = s & "         eval(oSelect.sVLocation).innerHTML=oSelect.getText();" & vbCrLf
s = s & "         eval(oSelect.sFLocation).value=oSelect.getValue();" & vbCrLf
s = s & "         eval(oSelect.sTLocation).title=oSelect.getText();" & vbCrLf
s = s & "//       }" & vbCrLf
s = s & "}" & vbCrLf
s = s & "" & vbCrLf
s = s & "///////////////////////////////////////////////////////////" & vbCrLf
s = s & "// Private functions - used by the private methods above" & vbCrLf
s = s & "///////////////////////////////////////////////////////////" & vbCrLf
s = s & "" & vbCrLf
s = s & "function fnSelectOpenClose(sID)" & vbCrLf
s = s & "{" & vbCrLf
s = s & " var oSelect=fnPopSelect(sID);" & vbCrLf
s = s & " var oPane=eval(oSelect.sPLocation);" & vbCrLf
s = s & " if(oPane.style.visibility==""visible"")" & vbCrLf
s = s & " {" & vbCrLf
s = s & "         fnSelectClose(oSelect);" & vbCrLf
s = s & " }" & vbCrLf
s = s & " else" & vbCrLf
s = s & " {" & vbCrLf
s = s & "         fnSelectOpen(oSelect);" & vbCrLf
s = s & " }" & vbCrLf
s = s & "}" & vbCrLf
s = s & "function fnSelectOpen(oSelect)" & vbCrLf
s = s & "{" & vbCrLf
s = s & " var oSelectDiv=eval(oSelect.sLocation);" & vbCrLf
s = s & " var oPane=eval(oSelect.sPLocation);" & vbCrLf
s = s & " oPane.style.top=fnOffsetTop(oSelect)+oSelectDiv.offsetHeight;" & vbCrLf
s = s & " oPane.style.left=fnOffsetLeft(oSelect); //oSelectDiv.style.left;" & vbCrLf
s = s & " oPane.style.visibility=""visible"";" & vbCrLf
s = s & "}" & vbCrLf
s = s & "function fnSelectClose(oSelect)" & vbCrLf
s = s & "{" & vbCrLf
s = s & " var oPane=eval(oSelect.sPLocation);" & vbCrLf
s = s & " oPane.style.top=0;" & vbCrLf
s = s & " oPane.style.left=0;" & vbCrLf
s = s & " oPane.style.visibility=""hidden"";" & vbCrLf
s = s & "}" & vbCrLf
s = s & "function fnSelectClick(sID,sIndex)" & vbCrLf
s = s & "{" & vbCrLf
s = s & " var oSelect=fnPopSelect(sID);" & vbCrLf
s = s & " if(oSelect.sIndex!=sIndex)" & vbCrLf
s = s & " {" & vbCrLf
s = s & "         //value has changed             " & vbCrLf
s = s & "         fnSetValue(oSelect,sIndex);             " & vbCrLf
s = s & "         fnSelectChange(sID,fnGetValue(oSelect));" & vbCrLf
s = s & " }" & vbCrLf
s = s & " fnSelectClose(oSelect);" & vbCrLf
s = s & "}" & vbCrLf
s = s & "function fnOffsetTop(oSelect)" & vbCrLf
s = s & "{" & vbCrLf
s = s & " var n=0;" & vbCrLf
s = s & " var oElement=eval(oSelect.sLocation);" & vbCrLf
s = s & " while (oElement.tagName.toLowerCase()!=""body"")" & vbCrLf
s = s & " {" & vbCrLf
s = s & "         if(oElement.tagName.toLowerCase()==""div"")" & vbCrLf
s = s & "         {" & vbCrLf
s = s & "                 n+=oElement.offsetTop;" & vbCrLf
s = s & "         }" & vbCrLf
s = s & "         oElement=oElement.parentElement;" & vbCrLf
s = s & " }" & vbCrLf
s = s & " return n;" & vbCrLf
s = s & "}" & vbCrLf
s = s & "function fnOffsetLeft(oSelect)" & vbCrLf
s = s & "{" & vbCrLf
s = s & " var n=0;" & vbCrLf
s = s & " var oElement=eval(oSelect.sLocation);" & vbCrLf
s = s & " while (oElement.tagName.toLowerCase()!=""body"")" & vbCrLf
s = s & " {" & vbCrLf
s = s & "         if(oElement.tagName.toLowerCase()==""div"")" & vbCrLf
s = s & "         {" & vbCrLf
s = s & "                 n+=oElement.offsetLeft;" & vbCrLf
s = s & "         }" & vbCrLf
s = s & "         oElement=oElement.parentElement;" & vbCrLf
s = s & " }" & vbCrLf
s = s & " return n+1;" & vbCrLf
s = s & "}" & vbCrLf
s = s & "function fnDraw(oSelect)" & vbCrLf
s = s & "{" & vbCrLf
s = s & " //select box" & vbCrLf
s = s & " var osHTML=new Array();" & vbCrLf
s = s & " osHTML.push(""<table id='sel_table_""+oSelect.sID+""' onclick='fnSelectOpenClose(\""""+oSelect.sID+""\"");' cellpadding='0' cellspacing='0' border='0'>"");" & vbCrLf
s = s & " osHTML.push(""<tr id='""+oSelect.sID+""_t' class='clsMSelectList' valign='middle'>"");" & vbCrLf
s = s & " osHTML.push(""<td align='""+fnAlign(oSelect.nAlign)+""'>"");" & vbCrLf
s = s & " osHTML.push(""<div id='""+oSelect.sID+""_s' class='clsMSelectList' style='z-index:9; height:""+oSelect.nHeight+""px;width:""+(oSelect.nWidth-16)+""px;'>"");" & vbCrLf
s = s & " osHTML.push(""<div id='""+oSelect.sID+""_v'></div>"");" & vbCrLf
s = s & " osHTML.push(""</div>"");" & vbCrLf
s = s & " osHTML.push(""</td><td valign='top'><div style='height:""+oSelect.nHeight+""px; width:16px' class='clsMSelectButton'><img onmouseout='fnMU(this)' onmousedown='fnMD(this)' onmouseup='fnMU(this)' src='../img/exp_inactive.gif'></div></td></tr>"");" & vbCrLf
s = s & " osHTML.push(""<input type='hidden' value='' name='""+oSelect.sID+""'>"")" & vbCrLf
s = s & " eval(oSelect.sLocation).innerHTML=osHTML.join('');      " & vbCrLf
s = s & "}" & vbCrLf
s = s & "function fnPopulate(oSelect,sList,bInit)" & vbCrLf
s = s & "{" & vbCrLf
s = s & " oSelect.olNames=null;" & vbCrLf
s = s & " oSelect.olNames=new Array();" & vbCrLf
s = s & " var sStart='\\|';" & vbCrLf
s = s & " var sTerm = ""([^|]*)"";" & vbCrLf
s = s & " var sDel = '\`';" & vbCrLf
s = s & " var sHTML;" & vbCrLf
s = s & "" & vbCrLf
s = s & " if((sList!=undefined)&&(sList!=""""))" & vbCrLf
s = s & " {" & vbCrLf
s = s & "         var sAlign=""align='""+fnAlign(oSelect.nAlign)+""' "";" & vbCrLf
s = s & "         var aValues=sList.split(""|""); " & vbCrLf
s = s & "" & vbCrLf
s = s & "         for(var n=1;n<aValues.length;n++)" & vbCrLf
s = s & "         {" & vbCrLf
s = s & "                 var aValue=aValues[n].split(""`"");" & vbCrLf
s = s & "                 //populate select object's internal arrays" & vbCrLf
s = s & "                 oSelect.olNames[aValue[0]]=aValue[1];           " & vbCrLf
s = s & "         }" & vbCrLf
s = s & "         //use regular expression to build select html" & vbCrLf
s = s & "         sHTML=sList.replace(new RegExp(sStart+sTerm+sDel+sTerm,'g'),'<tr height=""10"" id=""'+oSelect.sID+'~$1""><a style=""text-decoration:none;"" href=""javascript:fnSelectClick(\''+oSelect.sID+'\',\'$1\');""><td '+sAlign+' title=""$2"">$2</td></a></tr>')" & vbCrLf
s = s & "         eval(oSelect.sPLocation).innerHTML=""<table id='""+oSelect.sID+""_pt' cellpadding='0' cellspacing='0' onclick='fnOnClick(this)' onmouseover='fnOnMouseOver(this,0);' onmouseout='fnOnMouseOut(this);' width='100%' class='clsTableText'>""+sHTML+""</table>"";" & vbCrLf
s = s & "" & vbCrLf
s = s & "         if(aValues.length>0)" & vbCrLf
s = s & "         { " & vbCrLf
s = s & "                 fnSelectRow(document.all[oSelect.sID+""_pt""],0);                       " & vbCrLf
s = s & "                 fnSetValue(oSelect,aValues[1].split(""`"")[0]);" & vbCrLf
s = s & "         }" & vbCrLf
s = s & " }" & vbCrLf
s = s & " else" & vbCrLf
s = s & " {" & vbCrLf
s = s & "         eval(oSelect.sPLocation).innerHTML="""";" & vbCrLf
s = s & "         fnSetValue(oSelect,null);" & vbCrLf
s = s & " }" & vbCrLf
s = s & " if(bInit) fnInitZOrder();       " & vbCrLf
s = s & "}" & vbCrLf
s = s & "function fnSelectCloseAll(sID)" & vbCrLf
s = s & "{" & vbCrLf
s = s & " for (var n=0;n<aSelectObjects.length;n++)" & vbCrLf
s = s & " {" & vbCrLf
s = s & "         if(aSelectObjects[n].sID!=sID) fnSelectClose(aSelectObjects[n]);" & vbCrLf
s = s & " }" & vbCrLf
s = s & "}" & vbCrLf
s = s & "function fnMD(oImg)" & vbCrLf
s = s & "{" & vbCrLf
s = s & "//       oImg.src=""../img/exp_active.gif""" & vbCrLf
s = s & "}" & vbCrLf
s = s & "function fnMU(oImg)" & vbCrLf
s = s & "{" & vbCrLf
s = s & "//       oImg.src=""../img/exp_inactive.gif""" & vbCrLf
s = s & "}" & vbCrLf
s = s & "function fnAlign(nAlign)" & vbCrLf
s = s & "{" & vbCrLf
s = s & " switch (nAlign)" & vbCrLf
s = s & " {" & vbCrLf
s = s & "         case eAlignLeft: return ""left"";break;" & vbCrLf
s = s & "         case eAlignCentre: return ""center"";break;" & vbCrLf
s = s & "         case eAlignRight: return ""right"";break;" & vbCrLf
s = s & " }" & vbCrLf
s = s & "}" & vbCrLf
s = s & ""
CompiledSelectListJS = s
End Function

